<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VirtualFusion Zero Trust Assessment Platform</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --primary-blue: #2563EB;
            --primary-blue-dark: #1E40AF;
            --primary-blue-light: #DBEAFE;
            --success-green: #10B981;
            --success-green-dark: #059669;
            --warning-orange: #F59E0B;
            --warning-orange-dark: #D97706;
            --danger-red: #EF4444;
            --dark-bg: #1F2937;
            --light-bg: #F9FAFB;
            --border-color: #E5E7EB;
            --text-primary: #111827;
            --text-secondary: #6B7280;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--light-bg);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-blue-dark) 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .stepper {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            position: relative;
            padding: 20px 0;
        }

        .stepper::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--border-color);
            z-index: 0;
        }

        .step {
            flex: 1;
            text-align: center;
            position: relative;
            z-index: 1;
            cursor: pointer;
        }

        .step-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: white;
            border: 3px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: 600;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .step.active .step-circle {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 4px var(--primary-blue-light);
        }

        .step.completed .step-circle {
            background: var(--success-green);
            color: white;
            border-color: var(--success-green);
        }

        .step-label {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .step.active .step-label {
            color: var(--primary-blue);
            font-weight: 600;
        }

        .step-content {
            display: none;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .step-content.active {
            display: block;
        }

        .step-header {
            margin-bottom: 30px;
        }

        .step-header h2 {
            font-size: 28px;
            color: var(--dark-bg);
            margin-bottom: 8px;
        }

        .step-header p {
            color: var(--text-secondary);
            font-size: 16px;
        }

        .intro-box {
            background: linear-gradient(135deg, #EFF6FF 0%, #DBEAFE 100%);
            border-left: 4px solid var(--primary-blue);
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(37, 99, 235, 0.1);
        }

        .intro-box h3 {
            color: var(--primary-blue);
            margin-bottom: 12px;
            font-size: 20px;
        }

        .intro-box p {
            color: #1E40AF;
            line-height: 1.7;
            margin-bottom: 16px;
        }

        .action-callout {
            background: linear-gradient(135deg, var(--success-green) 0%, var(--success-green-dark) 100%);
            color: white;
            padding: 24px;
            border-radius: 12px;
            margin: 24px 0;
            box-shadow: 0 4px 16px rgba(16, 185, 129, 0.3);
        }

        .action-callout h3 {
            margin-bottom: 16px;
            font-size: 20px;
        }

        .action-callout ol {
            margin-left: 24px;
            line-height: 2.2;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-bg);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-blue-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .btn-success {
            background: var(--success-green);
            color: white;
        }

        .btn-success:hover {
            background: var(--success-green-dark);
        }

        .btn-secondary {
            background: var(--text-secondary);
            color: white;
        }

        .maturity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .consolidated-assessment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 24px;
            margin: 30px 0;
        }

        .consolidated-assessment-card {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .consolidated-assessment-card:hover {
            border-color: var(--primary-blue);
            box-shadow: 0 4px 16px rgba(37, 99, 235, 0.2);
            transform: translateY(-2px);
        }

        .maturity-card {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .maturity-card:hover {
            border-color: var(--primary-blue);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);
        }

        .maturity-card.expanded {
            border-color: var(--primary-blue);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);
        }

        .maturity-card h4 {
            color: var(--dark-bg);
            margin-bottom: 16px;
            font-size: 18px;
        }

        .maturity-level {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .maturity-level-bar {
            flex: 1;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
        }

        .maturity-level-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success-green), var(--success-green-dark));
            transition: width 0.5s ease;
        }

        .maturity-level-fill.warning {
            background: linear-gradient(90deg, var(--warning-orange), var(--warning-orange-dark));
        }

        .maturity-level-fill.danger {
            background: linear-gradient(90deg, var(--danger-red), #DC2626);
        }

        .gap-analysis-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            background: white;
            border-radius: 12px;
            overflow: hidden;
        }

        .gap-analysis-table th {
            background: var(--primary-blue);
            color: white;
            padding: 16px;
            text-align: left;
            font-weight: 600;
        }

        .gap-analysis-table td {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .gap-analysis-table tr:hover {
            background: #F9FAFB;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-success {
            background: #D1FAE5;
            color: #065F46;
        }

        .badge-warning {
            background: #FEF3C7;
            color: #92400E;
        }

        .badge-danger {
            background: #FEE2E2;
            color: #991B1B;
        }

        .badge-info {
            background: #DBEAFE;
            color: #1E40AF;
        }

        .visualization-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin: 30px 0;
            border: 2px solid var(--border-color);
        }

        .tool-mapping-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .tool-card {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
        }

        .tool-card:hover {
            border-color: var(--primary-blue);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);
        }

        .tool-card h5 {
            color: var(--dark-bg);
            margin-bottom: 8px;
            font-size: 16px;
        }

        .tool-card p {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
        }

        .reference-box {
            background: #FEF3C7;
            border-left: 4px solid var(--warning-orange);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .reference-box h4 {
            color: #92400E;
            margin-bottom: 12px;
        }

        .reference-box ul {
            color: #78350F;
            margin-left: 20px;
            line-height: 1.8;
        }

        .roadmap-item {
            background: white;
            border-left: 4px solid var(--primary-blue);
            padding: 24px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .roadmap-item h4 {
            color: var(--dark-bg);
            margin-bottom: 12px;
        }

        .roadmap-item .priority {
            display: inline-block;
            margin-bottom: 12px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
            margin: 12px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-blue), var(--primary-blue-dark));
            transition: width 0.5s ease;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid var(--border-color);
        }

        .device-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }

        .device-table th {
            background: var(--primary-blue);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .device-table td {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            font-size: 13px;
        }

        .device-table tr:hover {
            background: #F9FAFB;
        }

        .topology-visual {
            min-height: 400px;
            background: #F9FAFB;
            border-radius: 8px;
            padding: 20px;
            position: relative;
        }

        .card-details {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #F9FAFB;
            border-radius: 8px;
            border-left: 4px solid var(--primary-blue);
        }

        .card-details.active {
            display: block;
        }

        .card-details h5 {
            color: var(--dark-bg);
            margin-bottom: 12px;
        }

        .card-details table {
            width: 100%;
            margin-top: 12px;
        }

        .card-details table td {
            padding: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .close-btn {
            float: right;
            background: var(--text-secondary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .close-btn:hover {
            background: var(--dark-bg);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid var(--success-green);
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        .heatmap-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }

        .heatmap-cell {
            padding: 16px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            color: white;
            transition: transform 0.2s;
        }

        .heatmap-cell:hover {
            transform: scale(1.05);
        }

        .heatmap-critical {
            background: linear-gradient(135deg, #DC2626, #991B1B);
        }

        .heatmap-high {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }

        .heatmap-medium {
            background: linear-gradient(135deg, #FBBF24, #F59E0B);
        }

        .heatmap-low {
            background: linear-gradient(135deg, #10B981, #059669);
        }

        .network-topology {
            position: relative;
            min-height: 800px;
            background: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%);
            border-radius: 8px;
            padding: 40px;
            overflow: auto;
        }

        .network-zone {
            position: absolute;
            border: 3px solid;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .network-zone.dmz {
            border-color: #EF4444;
            background: rgba(254, 226, 226, 0.3);
        }

        .network-zone.internal {
            border-color: #2563EB;
            background: rgba(219, 234, 254, 0.3);
        }

        .network-zone.management {
            border-color: #10B981;
            background: rgba(209, 250, 229, 0.3);
        }

        .network-zone.data {
            border-color: #8B5CF6;
            background: rgba(237, 233, 254, 0.3);
        }

        .network-zone-label {
            position: absolute;
            top: -15px;
            left: 15px;
            background: white;
            padding: 4px 12px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .network-device {
            position: absolute;
            background: white;
            border: 2px solid;
            border-radius: 6px;
            padding: 8px 12px;
            min-width: 100px;
            text-align: center;
            font-size: 11px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            cursor: pointer;
            transition: all 0.3s;
            z-index: 10;
        }

        .network-device:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            z-index: 20;
        }

        .network-device.firewall {
            border-color: #EF4444;
            background: #FEE2E2;
        }

        .network-device.switch {
            border-color: #2563EB;
            background: #DBEAFE;
        }

        .network-device.router {
            border-color: #10B981;
            background: #D1FAE5;
        }

        .network-device.loadbalancer {
            border-color: #F59E0B;
            background: #FEF3C7;
        }

        .network-device.server {
            border-color: #8B5CF6;
            background: #EDE9FE;
        }

        .network-device.wifi {
            border-color: #EC4899;
            background: #FCE7F3;
        }

        .network-connection-line {
            position: absolute;
            border: 2px solid #94A3B8;
            pointer-events: none;
            z-index: 1;
        }

        .network-connection-line.redundant {
            border-style: dashed;
            opacity: 0.6;
        }

        .network-connection-line.critical {
            border-color: #EF4444;
            border-width: 3px;
        }

        .network-layer {
            position: absolute;
            border: 2px dashed #CBD5E1;
            border-radius: 8px;
            pointer-events: none;
            z-index: 0;
        }

        .network-layer-label {
            position: absolute;
            background: rgba(255, 255, 255, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            color: #64748B;
        }

        .tool-mapping-visual {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }

        .domain-box {
            background: white;
            border: 3px solid var(--primary-blue);
            border-radius: 12px;
            padding: 24px;
            position: relative;
        }

        .domain-box h4 {
            color: var(--primary-blue);
            margin-bottom: 20px;
            font-size: 20px;
            text-align: center;
        }

        .tool-list {
            list-style: none;
            padding: 0;
        }

        .tool-list li {
            background: #F0F9FF;
            padding: 10px 16px;
            margin-bottom: 8px;
            border-radius: 6px;
            border-left: 3px solid var(--primary-blue);
            font-size: 14px;
        }

        .gap-overlay {
            position: absolute;
            background: rgba(239, 68, 68, 0.2);
            border: 2px dashed #EF4444;
            border-radius: 4px;
            pointer-events: none;
            z-index: 10;
        }

        .gap-overlay.high {
            background: rgba(245, 158, 11, 0.2);
            border-color: #F59E0B;
        }

        .gap-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #EF4444;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            z-index: 15;
            cursor: pointer;
        }

        .gap-marker.high {
            background: #F59E0B;
        }

        .gap-tooltip {
            position: absolute;
            background: white;
            border: 2px solid #EF4444;
            border-radius: 8px;
            padding: 12px;
            min-width: 200px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 20;
            display: none;
        }

        .gap-tooltip.show {
            display: block;
        }

        .architecture-diagram {
            position: relative;
            min-height: 500px;
            background: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%);
            border-radius: 12px;
            padding: 40px;
            margin: 30px 0;
        }

        .arch-layer {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
            transition: all 0.3s ease;
        }

        .arch-layer.has-gap {
            border-color: #EF4444;
            background: #FEE2E2;
        }

        .arch-layer.has-gap.high {
            border-color: #F59E0B;
            background: #FEF3C7;
        }

        .arch-layer:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border-color: var(--primary-blue);
        }

        .arch-layer.has-gap:hover {
            box-shadow: 0 4px 16px rgba(239, 68, 68, 0.3);
        }

        .arch-layer.has-gap.high:hover {
            box-shadow: 0 4px 16px rgba(245, 158, 11, 0.3);
        }

        .roadmap-timeline {
            position: relative;
            padding: 40px 0;
            margin: 40px 0;
        }

        .roadmap-timeline::before {
            content: '';
            position: absolute;
            left: 100px;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--border-color);
        }

        .roadmap-phase {
            position: relative;
            margin-bottom: 60px;
            padding-left: 180px;
        }

        .roadmap-phase::before {
            content: '';
            position: absolute;
            left: 92px;
            top: 20px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            border: 4px solid var(--primary-blue);
            z-index: 2;
        }

        .roadmap-phase.critical::before {
            border-color: #EF4444;
        }

        .roadmap-phase.high::before {
            border-color: #F59E0B;
        }

        .roadmap-phase.medium::before {
            border-color: #10B981;
        }

        .roadmap-phase-card {
            background: white;
            border-left: 4px solid var(--primary-blue);
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .roadmap-phase.critical .roadmap-phase-card {
            border-left-color: #EF4444;
        }

        .roadmap-phase.high .roadmap-phase-card {
            border-left-color: #F59E0B;
        }

        .roadmap-phase.medium .roadmap-phase-card {
            border-left-color: #10B981;
        }

        .phase-date {
            position: absolute;
            left: 0;
            top: 10px;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Modal Overlay Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            overflow-y: auto;
            padding: 40px 20px;
        }

        .modal-overlay.active {
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 1000px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            position: relative;
            margin: auto;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-blue-dark) 100%);
            color: white;
            padding: 24px 30px;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 24px;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 30px;
        }

        .roadmap-item {
            cursor: pointer;
            transition: all 0.3s;
        }

        .roadmap-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .roadmap-phase-card {
            cursor: pointer;
            transition: all 0.3s;
        }

        .roadmap-phase-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è VirtualFusion Zero Trust Assessment Platform</h1>
            <p>Comprehensive Zero Trust Assessment using CISA and Forrester ZTX Maturity Models</p>
        </div>

        <!-- Stepper Navigation -->
        <div class="stepper">
            <div class="step active" data-step="1" onclick="proceedToStep(1)">
                <div class="step-circle">1</div>
                <div class="step-label">Input Collection</div>
            </div>
            <div class="step" data-step="2" onclick="proceedToStep(2)">
                <div class="step-circle">2</div>
                <div class="step-label">ZT Assessment</div>
            </div>
            <div class="step" data-step="3" onclick="proceedToStep(3)">
                <div class="step-circle">3</div>
                <div class="step-label">ZT Gap Analysis</div>
            </div>
            <div class="step" data-step="4" onclick="proceedToStep(4)">
                <div class="step-circle">4</div>
                <div class="step-label">Security Layers</div>
            </div>
            <div class="step" data-step="5" onclick="proceedToStep(5)">
                <div class="step-circle">5</div>
                <div class="step-label">Gap Reporting</div>
            </div>
            <div class="step" data-step="6" onclick="proceedToStep(6)">
                <div class="step-circle">6</div>
                <div class="step-label">Roadmap</div>
            </div>
        </div>

        <!-- Step 1: Input Collection -->
        <div class="step-content active" id="step1">
            <div class="step-header">
                <h2>üìã Step 1: Input Collection & Network Discovery</h2>
                <p>Collect device configurations, network topology, and design documents (HLD/LLD)</p>
            </div>

            <div class="intro-box">
                <h3>üí° What We're Doing in This Step</h3>
                <p>
                    We're discovering your complete network topology by automatically pulling device inventory from your VirtualFusion Platform Graph Database. 
                    If you have High-Level Design (HLD) or Low-Level Design (LLD) documents, we'll also analyze those to extract additional network details.
                </p>
            </div>

            <div class="form-group">
                <label>Platform Graph Database Integration</label>
                <div style="background: #F0FDF4; padding: 16px; border-radius: 8px; border-left: 3px solid var(--success-green);">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                        <div class="spinner" id="loadingSpinner"></div>
                        <div>
                            <div style="font-weight: 600; color: #065F46;">üîÑ Loading Device Inventory</div>
                            <div style="font-size: 13px; color: #047857;" id="loadingStatus">Querying Graph Database for device configurations...</div>
                        </div>
                    </div>
                    <div id="deviceCount" style="color: #047857; font-weight: 600;">Loading...</div>
                </div>
            </div>

            <div class="form-group">
                <label>Device Inventory (<span id="totalDevices">0</span> devices discovered)</label>
                <div style="max-height: 400px; overflow-y: auto; border: 2px solid var(--border-color); border-radius: 8px;">
                    <table class="device-table" id="deviceTable">
                        <thead>
                            <tr>
                                <th>Device Name</th>
                                <th>Type</th>
                                <th>IP Address</th>
                                <th>Location</th>
                                <th>OS/Version</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="deviceTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="form-group">
                <label>Network Topology Visualization</label>
                <div class="visualization-container">
                    <h4 style="margin-bottom: 16px;">Current Network Architecture - Ready for Zero Trust Mapping</h4>
                    <div class="network-topology" id="topologyVisualization">
                        <!-- Network topology will be drawn here -->
                    </div>
                </div>
            </div>

            <div class="navigation-buttons">
                <div></div>
                <button class="btn btn-primary" onclick="proceedToStep(2)">Proceed to Assessment ‚Üí</button>
            </div>
        </div>

        <!-- Step 2: Zero Trust Assessment -->
        <div class="step-content" id="step2">
            <div class="step-header">
                <h2>üîç Step 2: Zero Trust Maturity Assessment</h2>
                <p>Combined CISA and Forrester ZTX maturity assessment with tool mapping</p>
            </div>

            <div class="intro-box">
                <h3>üí° What We're Doing in This Step</h3>
                <p>
                    We're running a comprehensive Zero Trust assessment against two industry-standard maturity models: 
                    <strong>CISA Zero Trust Maturity Model</strong> and <strong>Forrester ZTX (Zero Trust eXtended)</strong>. 
                    This assessment maps your current security posture across User, Network, and Data Center domains.
                </p>
            </div>

            <div style="background: #F0F9FF; border-left: 4px solid var(--primary-blue); padding: 24px; border-radius: 8px; margin: 30px 0;">
                <h3 style="margin: 0 0 20px 0; color: var(--primary-blue); font-size: 20px;">üìö Understanding the Maturity Assessment Frameworks</h3>
                <p style="color: var(--text-secondary); margin-bottom: 24px; line-height: 1.6;">
                    We use two complementary frameworks to provide a comprehensive view of your Zero Trust maturity. Here's what each framework brings to the assessment:
                </p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div style="background: white; padding: 20px; border-radius: 8px; border: 2px solid #DBEAFE;">
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="background: #2563EB; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 18px; margin-right: 12px;">CISA</div>
                            <h4 style="margin: 0; color: var(--dark-bg);">CISA Zero Trust Maturity Model</h4>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6; margin-bottom: 12px;">
                            <strong>Created by:</strong> Cybersecurity and Infrastructure Security Agency (CISA), a U.S. federal agency
                        </p>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6; margin-bottom: 12px;">
                            <strong>Focus:</strong> Government and enterprise security with emphasis on five core pillars: <strong>Identity</strong>, <strong>Devices</strong>, <strong>Networks</strong>, <strong>Applications</strong>, and <strong>Data</strong>.
                        </p>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6; margin-bottom: 12px;">
                            <strong>Maturity Levels:</strong> Traditional ‚Üí Initial ‚Üí Advanced ‚Üí Optimal
                        </p>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            <strong>Best For:</strong> Organizations seeking a structured, government-aligned approach to Zero Trust implementation with clear progression stages.
                        </p>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 8px; border: 2px solid #FEF3C7;">
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="background: #F59E0B; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 18px; margin-right: 12px;">ZTX</div>
                            <h4 style="margin: 0; color: var(--dark-bg);">Forrester ZTX (Zero Trust eXtended)</h4>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6; margin-bottom: 12px;">
                            <strong>Created by:</strong> Forrester Research, a leading technology research and advisory firm
                        </p>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6; margin-bottom: 12px;">
                            <strong>Focus:</strong> Business-oriented approach covering seven domains: <strong>Workforce</strong>, <strong>Workload</strong>, <strong>Workplace</strong>, <strong>Network</strong>, <strong>Device</strong>, <strong>Data</strong>, and <strong>Visibility & Analytics</strong>.
                        </p>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6; margin-bottom: 12px;">
                            <strong>Maturity Levels:</strong> Score-based (0-5 scale) with focus on business outcomes and user experience
                        </p>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            <strong>Best For:</strong> Organizations prioritizing business alignment, user experience, and comprehensive visibility across all Zero Trust domains.
                        </p>
                    </div>
                </div>
                
                <div style="background: #D1FAE5; border-left: 3px solid #10B981; padding: 16px; border-radius: 6px; margin-top: 20px;">
                    <h4 style="margin: 0 0 8px 0; color: #065F46; font-size: 16px;">ü§ù Why We Use Both Frameworks</h4>
                    <p style="margin: 0; color: #047857; font-size: 14px; line-height: 1.6;">
                        By combining <strong>CISA</strong> and <strong>Forrester ZTX</strong>, we provide a comprehensive assessment that covers both technical security controls (CISA) and business-aligned security outcomes (Forrester). This dual approach ensures you get a complete picture of your Zero Trust maturity, identifying gaps from both a compliance/government perspective and a business/operational perspective. The consolidated view below shows how these frameworks map together and provides tool recommendations for each domain.
                    </p>
                </div>
            </div>

            <h3 style="margin: 30px 0 20px 0; color: var(--dark-bg);">Consolidated Zero Trust Maturity Assessment</h3>
            <p style="color: var(--text-secondary); margin-bottom: 30px; font-size: 14px;">
                Combined CISA and Forrester ZTX maturity assessments with tool mapping per domain
            </p>
            <div class="consolidated-assessment-grid" id="consolidatedAssessmentGrid">
                <!-- Consolidated cards will be populated by JavaScript -->
            </div>

            <h3 style="margin: 40px 0 20px 0; color: var(--dark-bg);">Overall Zero Trust Maturity</h3>
            <div class="visualization-container">
                <h4 style="margin-bottom: 20px;">Combined Maturity Assessment Visualization</h4>
                <canvas id="overallMaturityChart"></canvas>
            </div>

            <div class="navigation-buttons">
                <button class="btn btn-secondary" onclick="proceedToStep(1)">‚Üê Back</button>
                <button class="btn btn-primary" onclick="proceedToStep(3)">Proceed to Gap Analysis ‚Üí</button>
            </div>
        </div>

        <!-- Step 3: ZT Gap Analysis -->
        <div class="step-content" id="step3">
            <div class="step-header">
                <h2>üìä Step 3: ZT Gap Analysis</h2>
                <p>Visual gap analysis heatmap based on collected network data</p>
            </div>

            <div class="intro-box">
                <h3>üí° What We're Doing in This Step</h3>
                <p>
                    We're analyzing the gaps between your current security implementation and the target Zero Trust architecture. 
                    Click on any card below to see detailed gap information.
                </p>
            </div>

            <h3 style="margin: 30px 0 20px 0; color: var(--dark-bg);">Gap Analysis Overlay on Network Architecture</h3>
            <div class="visualization-container">
                <h4 style="margin-bottom: 20px;">Current Network Architecture with Gap Overlays</h4>
                <div class="network-topology" id="gapAnalysisTopology" style="position: relative;">
                    <!-- Network topology with gap overlays will be drawn here -->
                </div>
            </div>

            <h3 style="margin: 40px 0 20px 0; color: var(--dark-bg);">Gap Analysis by Domain</h3>
            <div class="maturity-grid" id="gapAnalysisCards">
                <!-- Cards will be populated by JavaScript -->
            </div>

            <div class="navigation-buttons">
                <button class="btn btn-secondary" onclick="proceedToStep(2)">‚Üê Back</button>
                <button class="btn btn-primary" onclick="proceedToStep(4)">Proceed to Security Layers ‚Üí</button>
            </div>
        </div>

        <!-- Step 4: Security Layer Assessment -->
        <div class="step-content" id="step4">
            <div class="step-header">
                <h2>üîí Step 4: Security Layer Assessment</h2>
                <p>Evaluate security controls across all layers and identify gaps</p>
            </div>

            <div class="intro-box">
                <h3>üí° What We're Doing in This Step</h3>
                <p>
                    We're conducting a comprehensive security layer assessment to identify vulnerabilities, misconfigurations, 
                    and missing controls across all security layers.
                </p>
            </div>

            <h3 style="margin: 30px 0 20px 0; color: var(--dark-bg);">Security Layer Analysis</h3>
            <div class="maturity-grid" id="securityLayerCards">
                <!-- Cards will be populated by JavaScript -->
            </div>

            <div class="navigation-buttons">
                <button class="btn btn-secondary" onclick="proceedToStep(3)">‚Üê Back</button>
                <button class="btn btn-primary" onclick="proceedToStep(5)">Proceed to Gap Reporting ‚Üí</button>
            </div>
        </div>

        <!-- Step 5: Gap Reporting -->
        <div class="step-content" id="step5">
            <div class="step-header">
                <h2>üìã Step 5: Comprehensive Gap Reporting</h2>
                <p>Detailed gap analysis referencing Zero Trust and Security standards</p>
            </div>

            <div class="intro-box">
                <h3>üí° What We're Doing in This Step</h3>
                <p>
                    We're compiling a comprehensive gap report that references both Zero Trust maturity models (CISA and Forrester ZTX) 
                    and security best practices.
                </p>
            </div>

            <h3 style="margin: 30px 0 20px 0; color: var(--dark-bg);">Gap Analysis on Architectural Design</h3>
            <div class="architecture-diagram" id="gapArchitectureDiagram">
                <!-- Architectural design with gaps will be drawn here -->
            </div>

            <h3 style="margin: 40px 0 20px 0; color: var(--dark-bg);">Detailed Gap Reports</h3>
            <div id="gapReportsContainer">
                <!-- Reports will be populated by JavaScript -->
            </div>

            <div class="navigation-buttons">
                <button class="btn btn-secondary" onclick="proceedToStep(4)">‚Üê Back</button>
                <button class="btn btn-primary" onclick="proceedToStep(6)">Proceed to Roadmap ‚Üí</button>
            </div>
        </div>

        <!-- Modal Overlay -->
        <div class="modal-overlay" id="modalOverlay">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">Details</h3>
                    <button class="modal-close" onclick="closeModal()">‚úï</button>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- Modal content will be populated here -->
                </div>
            </div>
        </div>

        <!-- Step 6: Roadmap -->
        <div class="step-content" id="step6">
            <div class="step-header">
                <h2>üó∫Ô∏è Step 6: Zero Trust Implementation Roadmap</h2>
                <p>Prioritized implementation plan to achieve Zero Trust maturity</p>
            </div>

            <div class="intro-box">
                <h3>üí° What We're Doing in This Step</h3>
                <p>
                    We're building a comprehensive, prioritized roadmap to guide your Zero Trust implementation journey. 
                    The roadmap is organized by phases, with clear milestones, timelines, and success metrics.
                </p>
            </div>

            <h3 style="margin: 30px 0 20px 0; color: var(--dark-bg);">Implementation Roadmap Timeline</h3>
            <div class="roadmap-timeline" id="roadmapTimelineVisual">
                <!-- Roadmap timeline will be populated by JavaScript -->
            </div>

            <h3 style="margin: 40px 0 20px 0; color: var(--dark-bg);">Implementation Phases</h3>
            <div id="roadmapPhasesContainer">
                <!-- Phases will be populated by JavaScript -->
            </div>

            <div class="navigation-buttons">
                <button class="btn btn-secondary" onclick="proceedToStep(5)">‚Üê Back</button>
                <button class="btn btn-success" onclick="exportRoadmap()">üì• Export Roadmap</button>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentStep = 1;
        const totalSteps = 6;
        let deviceData = [];
        let charts = {};

        // Realistic enterprise network dummy data
        const enterpriseDevices = [
            { name: 'DC1-CORE-SW-01', type: 'Switch', ip: '10.0.1.1', location: 'Data Center 1', os: 'Cisco IOS 15.2', status: 'Active' },
            { name: 'DC1-CORE-SW-02', type: 'Switch', ip: '10.0.1.2', location: 'Data Center 1', os: 'Cisco IOS 15.2', status: 'Active' },
            { name: 'DC1-FW-01', type: 'Firewall', ip: '10.0.1.10', location: 'Data Center 1', os: 'Palo Alto PAN-OS 10.1', status: 'Active' },
            { name: 'DC1-FW-02', type: 'Firewall', ip: '10.0.1.11', location: 'Data Center 1', os: 'Palo Alto PAN-OS 10.1', status: 'Active' },
            { name: 'DC1-LB-01', type: 'Load Balancer', ip: '10.0.1.20', location: 'Data Center 1', os: 'F5 BIG-IP 16.1', status: 'Active' },
            { name: 'DC1-LB-02', type: 'Load Balancer', ip: '10.0.1.21', location: 'Data Center 1', os: 'F5 BIG-IP 16.1', status: 'Active' },
            { name: 'DC1-ROUTER-01', type: 'Router', ip: '10.0.1.30', location: 'Data Center 1', os: 'Cisco IOS XE 17.3', status: 'Active' },
            { name: 'DC1-ROUTER-02', type: 'Router', ip: '10.0.1.31', location: 'Data Center 1', os: 'Cisco IOS XE 17.3', status: 'Active' },
            { name: 'DC1-WEB-01', type: 'Server', ip: '10.0.2.10', location: 'Data Center 1', os: 'Linux Ubuntu 22.04', status: 'Active' },
            { name: 'DC1-WEB-02', type: 'Server', ip: '10.0.2.11', location: 'Data Center 1', os: 'Linux Ubuntu 22.04', status: 'Active' },
            { name: 'DC1-APP-01', type: 'Server', ip: '10.0.2.20', location: 'Data Center 1', os: 'Linux RHEL 8.5', status: 'Active' },
            { name: 'DC1-APP-02', type: 'Server', ip: '10.0.2.21', location: 'Data Center 1', os: 'Linux RHEL 8.5', status: 'Active' },
            { name: 'DC1-DB-01', type: 'Database Server', ip: '10.0.2.30', location: 'Data Center 1', os: 'Linux RHEL 8.5', status: 'Active' },
            { name: 'DC1-DB-02', type: 'Database Server', ip: '10.0.2.31', location: 'Data Center 1', os: 'Linux RHEL 8.5', status: 'Active' },
            { name: 'DC2-CORE-SW-01', type: 'Switch', ip: '10.1.1.1', location: 'Data Center 2', os: 'Cisco IOS 15.2', status: 'Active' },
            { name: 'DC2-CORE-SW-02', type: 'Switch', ip: '10.1.1.2', location: 'Data Center 2', os: 'Cisco IOS 15.2', status: 'Active' },
            { name: 'DC2-FW-01', type: 'Firewall', ip: '10.1.1.10', location: 'Data Center 2', os: 'Palo Alto PAN-OS 10.1', status: 'Active' },
            { name: 'DC2-LB-01', type: 'Load Balancer', ip: '10.1.1.20', location: 'Data Center 2', os: 'F5 BIG-IP 16.1', status: 'Active' },
            { name: 'BRANCH-01-SW', type: 'Switch', ip: '192.168.1.1', location: 'Branch Office 1', os: 'Cisco IOS 15.1', status: 'Active' },
            { name: 'BRANCH-01-FW', type: 'Firewall', ip: '192.168.1.10', location: 'Branch Office 1', os: 'Fortinet FortiOS 7.2', status: 'Active' },
            { name: 'BRANCH-02-SW', type: 'Switch', ip: '192.168.2.1', location: 'Branch Office 2', os: 'Cisco IOS 15.1', status: 'Active' },
            { name: 'BRANCH-02-FW', type: 'Firewall', ip: '192.168.2.10', location: 'Branch Office 2', os: 'Fortinet FortiOS 7.2', status: 'Active' },
            { name: 'BRANCH-03-SW', type: 'Switch', ip: '192.168.3.1', location: 'Branch Office 3', os: 'Cisco IOS 15.1', status: 'Active' },
            { name: 'BRANCH-03-FW', type: 'Firewall', ip: '192.168.3.10', location: 'Branch Office 3', os: 'Fortinet FortiOS 7.2', status: 'Active' },
            { name: 'HQ-CORE-SW-01', type: 'Switch', ip: '172.16.1.1', location: 'Headquarters', os: 'Cisco IOS 15.2', status: 'Active' },
            { name: 'HQ-CORE-SW-02', type: 'Switch', ip: '172.16.1.2', location: 'Headquarters', os: 'Cisco IOS 15.2', status: 'Active' },
            { name: 'HQ-FW-01', type: 'Firewall', ip: '172.16.1.10', location: 'Headquarters', os: 'Palo Alto PAN-OS 10.1', status: 'Active' },
            { name: 'HQ-FW-02', type: 'Firewall', ip: '172.16.1.11', location: 'Headquarters', os: 'Palo Alto PAN-OS 10.1', status: 'Active' },
            { name: 'HQ-WIFI-CONTROLLER', type: 'Wireless Controller', ip: '172.16.1.50', location: 'Headquarters', os: 'Cisco WLC 8.5', status: 'Active' },
            { name: 'HQ-AD-DC-01', type: 'Domain Controller', ip: '172.16.2.10', location: 'Headquarters', os: 'Windows Server 2022', status: 'Active' },
            { name: 'HQ-AD-DC-02', type: 'Domain Controller', ip: '172.16.2.11', location: 'Headquarters', os: 'Windows Server 2022', status: 'Active' },
            { name: 'HQ-FILE-01', type: 'File Server', ip: '172.16.2.20', location: 'Headquarters', os: 'Windows Server 2022', status: 'Active' },
            { name: 'HQ-EXCHANGE-01', type: 'Mail Server', ip: '172.16.2.30', location: 'Headquarters', os: 'Windows Server 2022', status: 'Active' },
            { name: 'REMOTE-USER-LAPTOP-001', type: 'Laptop', ip: 'DHCP', location: 'Remote', os: 'Windows 11 Pro', status: 'Active' },
            { name: 'REMOTE-USER-LAPTOP-002', type: 'Laptop', ip: 'DHCP', location: 'Remote', os: 'Windows 11 Pro', status: 'Active' },
            { name: 'REMOTE-USER-LAPTOP-003', type: 'Laptop', ip: 'DHCP', location: 'Remote', os: 'macOS 13.5', status: 'Active' },
            { name: 'REMOTE-USER-LAPTOP-004', type: 'Laptop', ip: 'DHCP', location: 'Remote', os: 'Windows 11 Pro', status: 'Active' },
            { name: 'REMOTE-USER-LAPTOP-005', type: 'Laptop', ip: 'DHCP', location: 'Remote', os: 'macOS 13.5', status: 'Active' }
        ];

        // CISA Maturity Data with detailed information
        const cisaMaturityData = [
            { 
                pillar: 'Identity', 
                current: 'Initial', 
                percentage: 35, 
                gap: 'Missing MFA, no identity governance framework',
                description: 'The Identity pillar focuses on verifying and managing user identities, authentication, and authorization. Currently at Initial maturity level with basic authentication mechanisms.',
                target: 'Advanced/Optimal',
                capabilities: ['Multi-factor authentication (MFA)', 'Identity governance framework', 'Single Sign-On (SSO)', 'Privileged Access Management (PAM)', 'Identity lifecycle management', 'Access certification and recertification'],
                gaps: ['No MFA implementation', 'No identity governance', 'No SSO', 'No PAM', 'Manual user provisioning/deprovisioning', 'No access reviews'],
                tools: ['Okta', 'Azure AD', 'Microsoft Entra ID', 'SailPoint', 'CyberArk', 'Ping Identity'],
                standards: ['NIST 800-63B', 'CISA Identity Pillar', 'ISO 27001 Access Control'],
                roadmap: 'Implement MFA (2-4 months), Deploy identity governance (4-6 months), Enable SSO (3-5 months)'
            },
            { 
                pillar: 'Devices', 
                current: 'Traditional', 
                percentage: 20, 
                gap: 'No device inventory management, missing device health attestation',
                description: 'The Devices pillar ensures all devices accessing resources are identified, inventoried, and their security posture is continuously verified.',
                target: 'Advanced/Optimal',
                capabilities: ['Device inventory management', 'Device health attestation', 'Endpoint Detection and Response (EDR)', 'Mobile Device Management (MDM)', 'Device compliance policies', 'Automated device remediation'],
                gaps: ['No device inventory', 'No health attestation', 'No EDR', 'No MDM', 'No compliance checking', 'Manual device management'],
                tools: ['Microsoft Intune', 'VMware Workspace ONE', 'CrowdStrike Falcon', 'SentinelOne', 'Jamf Pro', 'Tanium'],
                standards: ['CISA Devices Pillar', 'Forrester Device Domain', 'NIST 800-53 CM-7'],
                roadmap: 'Deploy UEM solution (3-5 months), Implement EDR (3-4 months), Enable health attestation (2-4 months)'
            },
            { 
                pillar: 'Networks', 
                current: 'Initial', 
                percentage: 40, 
                gap: 'Network segmentation incomplete, missing micro-segmentation capabilities',
                description: 'The Networks pillar focuses on network segmentation, traffic inspection, and secure network access controls.',
                target: 'Advanced/Optimal',
                capabilities: ['Micro-segmentation', 'Software-Defined Perimeter (SDP)', 'Network policy automation', 'Network monitoring and analytics', 'Zero Trust Network Access (ZTNA)', 'Dynamic policy enforcement'],
                gaps: ['No micro-segmentation', 'No SDP', 'Manual policy management', 'Limited network visibility', 'Traditional VPN access', 'No network analytics'],
                tools: ['Illumio', 'Guardicore', 'VMware NSX', 'Cisco ACI', 'Zscaler ZPA', 'Cloudflare Access'],
                standards: ['NIST 800-207', 'CISA Networks Pillar', 'Forrester Network Domain'],
                roadmap: 'Implement micro-segmentation (4-6 months), Deploy SDP (3-5 months), Enhance network monitoring (3-4 months)'
            },
            { 
                pillar: 'Applications', 
                current: 'Initial', 
                percentage: 30, 
                gap: 'No application-level access controls, missing API security policies',
                description: 'The Applications pillar ensures secure access to applications and APIs with fine-grained access controls and security policies.',
                target: 'Advanced/Optimal',
                capabilities: ['Application-level access controls', 'API security gateway', 'Web Application Firewall (WAF)', 'Application security testing', 'API rate limiting', 'Application monitoring'],
                gaps: ['No app-level controls', 'No API security', 'No WAF', 'No security testing', 'No API gateway', 'Limited application visibility'],
                tools: ['Kong API Gateway', 'Apigee', 'AWS WAF', 'Cloudflare WAF', 'Veracode', 'Checkmarx'],
                standards: ['OWASP Top 10', 'CISA Applications Pillar', 'Forrester Workload Domain'],
                roadmap: 'Deploy API gateway (3-5 months), Implement WAF (2-3 months), Enable security testing (3-4 months)'
            },
            { 
                pillar: 'Data', 
                current: 'Traditional', 
                percentage: 15, 
                gap: 'No data classification framework, missing encryption at rest',
                description: 'The Data pillar focuses on protecting data through classification, encryption, access controls, and data loss prevention.',
                target: 'Advanced/Optimal',
                capabilities: ['Data classification framework', 'Encryption at rest and in transit', 'Data Loss Prevention (DLP)', 'Data access governance', 'Data backup and recovery', 'Data access monitoring'],
                gaps: ['No data classification', 'No encryption at rest', 'No DLP', 'No data access controls', 'No backup strategy', 'No data monitoring'],
                tools: ['Microsoft Purview', 'Varonis', 'Forcepoint DLP', 'AWS KMS', 'Azure Key Vault', 'Veeam'],
                standards: ['NIST 800-175B', 'CISA Data Pillar', 'Forrester Data Domain', 'GDPR', 'HIPAA'],
                roadmap: 'Implement data classification (4-6 months), Deploy encryption (3-5 months), Enable DLP (4-6 months)'
            }
        ];

        // Forrester ZTX Data with detailed information
        const forresterData = [
            { 
                domain: 'Workforce', 
                score: 2.5, 
                percentage: 50,
                description: 'Workforce domain focuses on securing and managing user identities, access, and authentication across all systems and applications.',
                capabilities: ['Identity and access management', 'Multi-factor authentication', 'Single Sign-On', 'Privileged access management', 'Identity governance'],
                gaps: ['Limited MFA coverage', 'No SSO', 'Weak identity governance', 'No PAM', 'Manual access management'],
                tools: ['Okta', 'Azure AD', 'SailPoint', 'CyberArk', 'Ping Identity'],
                standards: ['Forrester Workforce Domain', 'CISA Identity Pillar', 'NIST 800-63B']
            },
            { 
                domain: 'Workload', 
                score: 2.0, 
                percentage: 40,
                description: 'Workload domain secures applications, containers, and workloads across cloud and on-premises environments.',
                capabilities: ['Application security', 'Container security', 'Workload protection', 'API security', 'Application monitoring'],
                gaps: ['Limited application security', 'No container security', 'No workload protection', 'Weak API security', 'No application monitoring'],
                tools: ['Prisma Cloud', 'Aqua Security', 'Twistlock', 'Kong API Gateway', 'Veracode'],
                standards: ['Forrester Workload Domain', 'CISA Applications Pillar', 'OWASP Top 10']
            },
            { 
                domain: 'Workplace', 
                score: 2.8, 
                percentage: 56,
                description: 'Workplace domain manages and secures collaboration tools, endpoints, and user workspaces.',
                capabilities: ['Endpoint management', 'Collaboration security', 'Workspace management', 'Device security', 'User experience'],
                gaps: ['Limited endpoint management', 'Basic collaboration security', 'No workspace management', 'Weak device security'],
                tools: ['VMware Workspace ONE', 'Citrix Workspace', 'Microsoft 365', 'Google Workspace'],
                standards: ['Forrester Workplace Domain', 'CISA Devices Pillar']
            },
            { 
                domain: 'Network', 
                score: 2.2, 
                percentage: 44,
                description: 'Network domain implements network segmentation, secure access, and network monitoring capabilities.',
                capabilities: ['Network segmentation', 'Zero Trust Network Access', 'Network monitoring', 'Traffic inspection', 'Policy automation'],
                gaps: ['Limited segmentation', 'No ZTNA', 'Basic network monitoring', 'Manual policy management'],
                tools: ['Cisco ACI', 'VMware NSX', 'Zscaler ZPA', 'Cloudflare Access', 'ExtraHop'],
                standards: ['Forrester Network Domain', 'CISA Networks Pillar', 'NIST 800-207']
            },
            { 
                domain: 'Device', 
                score: 1.8, 
                percentage: 36,
                description: 'Device domain manages and secures all devices accessing corporate resources, including endpoints and mobile devices.',
                capabilities: ['Device inventory', 'Device compliance', 'Endpoint protection', 'Mobile device management', 'Device health attestation'],
                gaps: ['No device inventory', 'No compliance checking', 'Basic endpoint protection', 'No MDM', 'No health attestation'],
                tools: ['Microsoft Intune', 'VMware Workspace ONE', 'CrowdStrike Falcon', 'SentinelOne', 'Jamf Pro'],
                standards: ['Forrester Device Domain', 'CISA Devices Pillar', 'NIST 800-53']
            },
            { 
                domain: 'Data', 
                score: 1.5, 
                percentage: 30,
                description: 'Data domain protects data through classification, encryption, access controls, and data loss prevention.',
                capabilities: ['Data classification', 'Data encryption', 'Data Loss Prevention', 'Data access controls', 'Data monitoring'],
                gaps: ['No data classification', 'Limited encryption', 'No DLP', 'Weak access controls', 'No data monitoring'],
                tools: ['Microsoft Purview', 'Varonis', 'Forcepoint DLP', 'AWS KMS', 'Azure Key Vault'],
                standards: ['Forrester Data Domain', 'CISA Data Pillar', 'GDPR', 'HIPAA']
            },
            { 
                domain: 'Visibility & Analytics', 
                score: 2.0, 
                percentage: 40,
                description: 'Visibility & Analytics domain provides comprehensive security monitoring, threat detection, and behavioral analytics.',
                capabilities: ['SIEM', 'Behavioral analytics', 'Threat intelligence', 'Security orchestration', 'Threat hunting'],
                gaps: ['No SIEM', 'No behavioral analytics', 'Limited threat intelligence', 'No SOAR', 'No threat hunting'],
                tools: ['Microsoft Sentinel', 'Splunk', 'Exabeam', 'Securonix', 'Recorded Future'],
                standards: ['Forrester Visibility & Analytics', 'CISA Visibility Domain', 'NIST 800-53']
            }
        ];

        // Comprehensive Gap Analysis Data
        const gapAnalysisData = [
            { 
                domain: 'Identity & Access', 
                current: 'Basic LDAP authentication, no MFA, manual user provisioning', 
                target: 'Multi-factor authentication, identity governance, SSO, automated lifecycle management', 
                gap: 'Missing MFA, IAM framework, identity lifecycle', 
                priority: 'Critical', 
                gaps: 5,
                detailedGaps: [
                    {
                        gap: 'Missing Multi-Factor Authentication (MFA)',
                        description: 'No MFA implementation for user authentication. All users rely solely on username/password credentials, creating significant security risk.',
                        impact: 'High risk of credential theft and unauthorized access. Vulnerable to phishing attacks and password breaches.',
                        tools: ['Okta', 'Azure AD MFA', 'Duo Security', 'Google Authenticator', 'Authy', 'Microsoft Authenticator'],
                        remediation: [
                            'Deploy MFA solution (Okta, Azure AD, or Duo recommended)',
                            'Enforce MFA for all user accounts, starting with privileged users',
                            'Configure backup authentication methods (SMS, email, hardware tokens)',
                            'Implement conditional access policies based on risk',
                            'Train users on MFA usage and security best practices'
                        ],
                        timeline: '2-4 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'Medium',
                        standards: ['NIST 800-63B', 'CISA Identity Pillar - Advanced Level', 'Forrester Workforce Domain'],
                        dependencies: ['Identity provider integration', 'User directory synchronization']
                    },
                    {
                        gap: 'No Identity Governance Framework',
                        description: 'Lack of centralized identity governance, access certification, and role-based access control (RBAC) framework.',
                        impact: 'Inability to manage user access lifecycle, orphaned accounts, excessive permissions, compliance violations.',
                        tools: ['SailPoint', 'CyberArk', 'Saviynt', 'ForgeRock', 'Ping Identity', 'Microsoft Entra ID Governance'],
                        remediation: [
                            'Deploy identity governance platform (SailPoint or CyberArk recommended)',
                            'Define role-based access control (RBAC) model',
                            'Implement access certification and recertification processes',
                            'Establish identity lifecycle management workflows',
                            'Configure automated provisioning and deprovisioning',
                            'Set up access request and approval workflows'
                        ],
                        timeline: '4-6 months',
                        cost: '$$$$ (High)',
                        complexity: 'High',
                        standards: ['ISO 27001 Access Control', 'CISA Identity Pillar - Optimal Level', 'Forrester Workforce Domain'],
                        dependencies: ['Directory services integration', 'Application connectors', 'HR system integration']
                    },
                    {
                        gap: 'Missing Single Sign-On (SSO)',
                        description: 'Users must authenticate separately to each application, leading to password fatigue and security risks.',
                        impact: 'Poor user experience, password reuse, increased support tickets, security vulnerabilities.',
                        tools: ['Okta', 'Azure AD SSO', 'Ping Identity', 'OneLogin', 'JumpCloud', 'Google Workspace SSO'],
                        remediation: [
                            'Deploy SSO solution (Okta or Azure AD recommended)',
                            'Configure SAML/OIDC/OAuth protocols for applications',
                            'Migrate applications to SSO-enabled authentication',
                            'Implement just-in-time (JIT) provisioning',
                            'Configure session management and timeout policies'
                        ],
                        timeline: '3-5 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'Medium',
                        standards: ['SAML 2.0', 'OAuth 2.0', 'OpenID Connect', 'CISA Identity Pillar - Advanced Level'],
                        dependencies: ['Identity provider setup', 'Application compatibility assessment']
                    },
                    {
                        gap: 'No Privileged Access Management (PAM)',
                        description: 'Administrative and privileged accounts lack specialized security controls and monitoring.',
                        impact: 'High risk of privilege escalation attacks, insider threats, and unauthorized administrative access.',
                        tools: ['CyberArk', 'BeyondTrust', 'Centrify', 'Thycotic', 'Microsoft Privileged Identity Management'],
                        remediation: [
                            'Deploy PAM solution (CyberArk or BeyondTrust recommended)',
                            'Identify and inventory all privileged accounts',
                            'Implement password vaulting and rotation',
                            'Configure just-in-time (JIT) privileged access',
                            'Enable session recording and monitoring',
                            'Implement least privilege access principles'
                        ],
                        timeline: '4-6 months',
                        cost: '$$$$ (High)',
                        complexity: 'High',
                        standards: ['NIST 800-53 AC-6', 'CISA Identity Pillar - Optimal Level', 'Forrester Workforce Domain'],
                        dependencies: ['Directory services', 'Target system integration']
                    },
                    {
                        gap: 'Weak Password Policies',
                        description: 'Current password policies do not meet industry standards (length, complexity, rotation requirements).',
                        impact: 'Vulnerable to brute force attacks, password cracking, and credential stuffing attacks.',
                        tools: ['Azure AD Password Protection', 'Specops Password Policy', 'Anixis Password Policy Enforcer'],
                        remediation: [
                            'Enforce strong password policies (minimum 14 characters, complexity requirements)',
                            'Implement password history and rotation policies',
                            'Deploy password breach detection (HIBP integration)',
                            'Enable passwordless authentication where possible',
                            'Implement account lockout policies',
                            'Educate users on password security best practices'
                        ],
                        timeline: '1-2 months',
                        cost: '$ (Low)',
                        complexity: 'Low',
                        standards: ['NIST 800-63B', 'CISA Identity Pillar - Initial Level'],
                        dependencies: ['Directory service configuration']
                    }
                ]
            },
            { 
                domain: 'Device Management', 
                current: 'Manual device inventory, no compliance checking, no health attestation', 
                target: 'Automated device inventory, health attestation, compliance policies, endpoint protection', 
                gap: 'No device management platform, missing health checks', 
                priority: 'Critical', 
                gaps: 4,
                detailedGaps: [
                    {
                        gap: 'No Device Inventory Management',
                        description: 'Manual tracking of devices, no centralized device registry, unknown devices on network.',
                        impact: 'Shadow IT, unmanaged devices, inability to track device lifecycle, security blind spots.',
                        tools: ['Microsoft Intune', 'VMware Workspace ONE', 'Jamf Pro', 'SCCM', 'Tanium', 'Lansweeper'],
                        remediation: [
                            'Deploy unified endpoint management (UEM) solution (Intune or Workspace ONE)',
                            'Implement device discovery and inventory automation',
                            'Configure device registration and enrollment processes',
                            'Establish device classification and tagging',
                            'Set up device lifecycle management workflows',
                            'Integrate with network access control (NAC)'
                        ],
                        timeline: '3-5 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'Medium',
                        standards: ['CISA Devices Pillar - Initial Level', 'Forrester Device Domain'],
                        dependencies: ['Directory services', 'Network infrastructure']
                    },
                    {
                        gap: 'Missing Device Health Attestation',
                        description: 'No capability to verify device security posture before granting network access.',
                        impact: 'Compromised or non-compliant devices can access network, increasing attack surface.',
                        tools: ['Microsoft Intune Compliance', 'VMware Workspace ONE Intelligence', 'Cisco ISE', 'Forescout'],
                        remediation: [
                            'Implement device compliance policies (OS version, encryption, antivirus status)',
                            'Configure health attestation checks before network access',
                            'Set up conditional access based on device compliance',
                            'Implement device remediation workflows',
                            'Enable continuous compliance monitoring'
                        ],
                        timeline: '2-4 months',
                        cost: '$$ (Medium)',
                        complexity: 'Medium',
                        standards: ['CISA Devices Pillar - Advanced Level', 'NIST 800-53 CM-7'],
                        dependencies: ['UEM platform', 'Network access control']
                    },
                    {
                        gap: 'No Endpoint Detection and Response (EDR)',
                        description: 'Lack of advanced endpoint security beyond basic antivirus, no threat detection and response capabilities.',
                        impact: 'Inability to detect advanced threats, slow incident response, limited visibility into endpoint activities.',
                        tools: ['CrowdStrike Falcon', 'SentinelOne', 'Microsoft Defender for Endpoint', 'Carbon Black', 'Trend Micro Apex One'],
                        remediation: [
                            'Deploy EDR solution (CrowdStrike or SentinelOne recommended)',
                            'Install agents on all endpoints (servers, workstations, laptops)',
                            'Configure detection rules and behavioral analytics',
                            'Set up automated response playbooks',
                            'Integrate with SIEM for centralized monitoring',
                            'Establish threat hunting capabilities'
                        ],
                        timeline: '3-4 months',
                        cost: '$$$$ (High)',
                        complexity: 'Medium',
                        standards: ['CISA Devices Pillar - Advanced Level', 'Forrester Device Domain', 'MITRE ATT&CK'],
                        dependencies: ['Endpoint agent deployment', 'SIEM integration']
                    },
                    {
                        gap: 'Missing Mobile Device Management (MDM)',
                        description: 'No management or security controls for mobile devices (smartphones, tablets).',
                        impact: 'Unmanaged mobile devices accessing corporate resources, data leakage risks, compliance violations.',
                        tools: ['Microsoft Intune', 'VMware Workspace ONE', 'Jamf Pro', 'MobileIron', 'IBM MaaS360'],
                        remediation: [
                            'Deploy MDM solution (Intune or Workspace ONE recommended)',
                            'Enroll corporate and BYOD mobile devices',
                            'Configure mobile application management (MAM)',
                            'Implement mobile device compliance policies',
                            'Enable remote wipe and device lock capabilities',
                            'Set up app protection policies'
                        ],
                        timeline: '2-3 months',
                        cost: '$$ (Medium)',
                        complexity: 'Low-Medium',
                        standards: ['CISA Devices Pillar - Advanced Level', 'Forrester Device Domain'],
                        dependencies: ['UEM platform', 'Email and application integration']
                    }
                ]
            },
            { 
                domain: 'Network Segmentation', 
                current: 'Basic VLAN segmentation, flat network architecture', 
                target: 'Micro-segmentation, software-defined perimeters, network policy automation', 
                gap: 'Missing micro-segmentation, no network policy automation', 
                priority: 'High', 
                gaps: 4,
                detailedGaps: [
                    {
                        gap: 'No Micro-segmentation',
                        description: 'Network relies on traditional VLAN-based segmentation, allowing lateral movement between segments.',
                        impact: 'Compromised device can access entire network segment, increased attack surface, difficult to contain breaches.',
                        tools: ['Illumio', 'Guardicore', 'VMware NSX', 'Cisco ACI', 'Palo Alto Prisma Access', 'Zscaler ZPA'],
                        remediation: [
                            'Deploy micro-segmentation solution (Illumio or Guardicore recommended)',
                            'Map application dependencies and traffic flows',
                            'Define micro-segmentation policies (least privilege)',
                            'Implement workload-level segmentation',
                            'Configure dynamic policy enforcement',
                            'Monitor and optimize segmentation policies'
                        ],
                        timeline: '4-6 months',
                        cost: '$$$$ (High)',
                        complexity: 'High',
                        standards: ['CISA Networks Pillar - Advanced Level', 'Forrester Network Domain', 'NIST 800-207'],
                        dependencies: ['Network infrastructure assessment', 'Application dependency mapping']
                    },
                    {
                        gap: 'Missing Software-Defined Perimeter (SDP)',
                        description: 'No zero trust network access, traditional VPN-based remote access with broad network access.',
                        impact: 'Over-privileged remote access, VPN vulnerabilities, inability to enforce least privilege access.',
                        tools: ['Zscaler ZPA', 'Cloudflare Access', 'Perimeter 81', 'Cato Networks', 'Twingate', 'NetFoundry'],
                        remediation: [
                            'Deploy SDP solution (Zscaler ZPA or Cloudflare Access recommended)',
                            'Replace or supplement traditional VPN',
                            'Configure application-specific access policies',
                            'Implement user-to-application segmentation',
                            'Enable continuous verification and monitoring',
                            'Integrate with identity provider for authentication'
                        ],
                        timeline: '3-5 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'Medium',
                        standards: ['CISA Networks Pillar - Optimal Level', 'Forrester Network Domain', 'NIST 800-207'],
                        dependencies: ['Identity provider', 'Application inventory']
                    },
                    {
                        gap: 'No Network Policy Automation',
                        description: 'Network security policies are manually configured and managed, leading to inconsistencies and errors.',
                        impact: 'Policy misconfigurations, slow policy deployment, compliance gaps, human errors.',
                        tools: ['Cisco DNA Center', 'VMware NSX Manager', 'Palo Alto Panorama', 'Fortinet FortiManager', 'Ansible', 'Terraform'],
                        remediation: [
                            'Deploy network policy automation platform',
                            'Define policy as code (Infrastructure as Code)',
                            'Implement automated policy validation and testing',
                            'Set up policy version control and rollback',
                            'Enable continuous compliance monitoring',
                            'Automate policy deployment workflows'
                        ],
                        timeline: '4-6 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'High',
                        standards: ['CISA Networks Pillar - Optimal Level', 'NIST 800-53'],
                        dependencies: ['Network infrastructure', 'Automation platform']
                    },
                    {
                        gap: 'Insufficient Network Monitoring',
                        description: 'Limited network visibility, no real-time traffic analysis, missing network behavior analytics.',
                        impact: 'Inability to detect network anomalies, slow threat detection, limited incident response capabilities.',
                        tools: ['ExtraHop', 'Darktrace', 'Vectra AI', 'Cisco Stealthwatch', 'Plixer', 'Kentik'],
                        remediation: [
                            'Deploy network detection and response (NDR) solution',
                            'Implement network traffic analysis (NTA)',
                            'Configure behavioral analytics and anomaly detection',
                            'Set up network flow monitoring',
                            'Integrate with SIEM for correlation',
                            'Establish network threat hunting capabilities'
                        ],
                        timeline: '3-4 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'Medium',
                        standards: ['CISA Networks Pillar - Advanced Level', 'Forrester Visibility Domain'],
                        dependencies: ['Network infrastructure', 'SIEM integration']
                    }
                ]
            },
            { 
                domain: 'Application Security', 
                current: 'Perimeter firewall only, no application-level controls', 
                target: 'Application-level access controls, API security, WAF, application monitoring', 
                gap: 'No app-level policies, missing API gateway security', 
                priority: 'High', 
                gaps: 4,
                detailedGaps: [
                    {
                        gap: 'No Application-Level Access Controls',
                        description: 'Applications rely solely on network perimeter security, no fine-grained access controls within applications.',
                        impact: 'Over-privileged application access, inability to enforce least privilege, increased attack surface.',
                        tools: ['Okta Advanced Server Access', 'CyberArk Conjur', 'HashiCorp Vault', 'AWS IAM', 'Azure RBAC', 'Google Cloud IAM'],
                        remediation: [
                            'Implement application-level identity and access management',
                            'Deploy API authentication and authorization',
                            'Configure role-based access control (RBAC) within applications',
                            'Implement attribute-based access control (ABAC) where applicable',
                            'Enable just-in-time (JIT) access provisioning',
                            'Set up access reviews and certifications'
                        ],
                        timeline: '4-6 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'High',
                        standards: ['CISA Applications Pillar - Advanced Level', 'Forrester Workload Domain', 'OWASP Top 10'],
                        dependencies: ['Identity provider', 'Application architecture review']
                    },
                    {
                        gap: 'Missing API Security',
                        description: 'APIs lack proper authentication, authorization, rate limiting, and security controls.',
                        impact: 'API vulnerabilities, data exposure, unauthorized access, API abuse and attacks.',
                        tools: ['Kong API Gateway', 'Apigee', 'AWS API Gateway', 'Azure API Management', 'MuleSoft', '3scale'],
                        remediation: [
                            'Deploy API gateway solution (Kong or Apigee recommended)',
                            'Implement API authentication (OAuth 2.0, API keys)',
                            'Configure API rate limiting and throttling',
                            'Enable API security scanning and testing',
                            'Implement API versioning and lifecycle management',
                            'Set up API monitoring and analytics'
                        ],
                        timeline: '3-5 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'Medium',
                        standards: ['OWASP API Security Top 10', 'CISA Applications Pillar - Advanced Level'],
                        dependencies: ['API inventory', 'Application architecture']
                    },
                    {
                        gap: 'No Web Application Firewall (WAF)',
                        description: 'Web applications lack specialized protection against web-based attacks and vulnerabilities.',
                        impact: 'Vulnerable to OWASP Top 10 attacks, SQL injection, XSS, DDoS attacks, data breaches.',
                        tools: ['AWS WAF', 'Azure Application Gateway WAF', 'Cloudflare WAF', 'F5 BIG-IP ASM', 'Imperva', 'Akamai Kona'],
                        remediation: [
                            'Deploy WAF solution (Cloudflare or AWS WAF recommended)',
                            'Configure WAF rules and policies',
                            'Enable DDoS protection',
                            'Implement bot management and mitigation',
                            'Set up custom rules for application-specific protection',
                            'Enable real-time threat intelligence feeds'
                        ],
                        timeline: '2-3 months',
                        cost: '$$ (Medium)',
                        complexity: 'Low-Medium',
                        standards: ['OWASP Top 10', 'CISA Applications Pillar - Advanced Level', 'PCI-DSS'],
                        dependencies: ['Web application inventory', 'Traffic routing']
                    },
                    {
                        gap: 'Missing Application Security Testing',
                        description: 'No automated security testing in CI/CD pipeline, limited application vulnerability scanning.',
                        impact: 'Vulnerable code deployed to production, security issues discovered late, increased remediation costs.',
                        tools: ['Veracode', 'Checkmarx', 'SonarQube', 'Snyk', 'WhiteSource', 'OWASP ZAP'],
                        remediation: [
                            'Integrate SAST (Static Application Security Testing) into CI/CD',
                            'Implement DAST (Dynamic Application Security Testing)',
                            'Enable software composition analysis (SCA) for dependencies',
                            'Configure automated security scanning in pipeline',
                            'Set up security gates and policy enforcement',
                            'Establish vulnerability management process'
                        ],
                        timeline: '3-4 months',
                        cost: '$$ (Medium)',
                        complexity: 'Medium',
                        standards: ['OWASP ASVS', 'CISA Applications Pillar - Advanced Level'],
                        dependencies: ['CI/CD pipeline', 'Development team engagement']
                    }
                ]
            },
            { 
                domain: 'Data Protection', 
                current: 'Basic encryption in transit, no encryption at rest, no data classification', 
                target: 'Encryption at rest and in transit, data classification framework, DLP, data access controls', 
                gap: 'Missing encryption at rest, no data classification framework', 
                priority: 'Critical', 
                gaps: 5,
                detailedGaps: [
                    {
                        gap: 'No Encryption at Rest',
                        description: 'Data stored in databases, file systems, and storage lacks encryption, exposing sensitive data to unauthorized access.',
                        impact: 'Data breach risk, compliance violations (GDPR, HIPAA), unauthorized data access, regulatory penalties.',
                        tools: ['Microsoft BitLocker', 'VeraCrypt', 'AWS KMS', 'Azure Key Vault', 'Google Cloud KMS', 'HashiCorp Vault'],
                        remediation: [
                            'Implement database encryption (TDE, column-level encryption)',
                            'Enable file system encryption (BitLocker, FileVault)',
                            'Deploy cloud storage encryption (AWS S3, Azure Blob)',
                            'Implement key management solution (AWS KMS, Azure Key Vault)',
                            'Configure encryption key rotation policies',
                            'Establish encryption key backup and recovery procedures'
                        ],
                        timeline: '3-5 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'Medium',
                        standards: ['NIST 800-175B', 'CISA Data Pillar - Advanced Level', 'Forrester Data Domain', 'GDPR', 'HIPAA'],
                        dependencies: ['Storage infrastructure', 'Key management system']
                    },
                    {
                        gap: 'Missing Data Classification Framework',
                        description: 'No systematic approach to classify data based on sensitivity, value, and regulatory requirements.',
                        impact: 'Inability to apply appropriate security controls, compliance gaps, over/under-protection of data.',
                        tools: ['Microsoft Purview', 'Varonis', 'Boldon James', 'Titus', 'Netwrix', 'Stealthbits'],
                        remediation: [
                            'Define data classification taxonomy (Public, Internal, Confidential, Restricted)',
                            'Deploy data classification solution (Microsoft Purview or Varonis)',
                            'Implement automated data discovery and classification',
                            'Configure classification labels and metadata',
                            'Train users on data classification procedures',
                            'Establish data handling policies based on classification'
                        ],
                        timeline: '4-6 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'Medium',
                        standards: ['ISO 27001 Information Classification', 'CISA Data Pillar - Advanced Level', 'GDPR'],
                        dependencies: ['Data discovery tools', 'User training']
                    },
                    {
                        gap: 'No Data Loss Prevention (DLP)',
                        description: 'Lack of controls to prevent unauthorized data exfiltration, sharing, or leakage.',
                        impact: 'Data leakage risks, insider threats, compliance violations, intellectual property theft.',
                        tools: ['Microsoft Purview DLP', 'Forcepoint DLP', 'Symantec DLP', 'Digital Guardian', 'Proofpoint DLP', 'McAfee DLP'],
                        remediation: [
                            'Deploy DLP solution (Microsoft Purview or Forcepoint recommended)',
                            'Define DLP policies based on data classification',
                            'Configure endpoint DLP (block/prevent data exfiltration)',
                            'Implement network DLP (monitor data in transit)',
                            'Enable cloud DLP (protect data in cloud services)',
                            'Set up DLP incident response workflows'
                        ],
                        timeline: '4-6 months',
                        cost: '$$$$ (High)',
                        complexity: 'High',
                        standards: ['CISA Data Pillar - Optimal Level', 'Forrester Data Domain', 'GDPR', 'PCI-DSS'],
                        dependencies: ['Data classification', 'Endpoint agents', 'Network infrastructure']
                    },
                    {
                        gap: 'Insufficient Data Access Controls',
                        description: 'Lack of fine-grained access controls for data, no data access monitoring or auditing.',
                        impact: 'Over-privileged data access, unauthorized data access, inability to track data usage.',
                        tools: ['Varonis', 'Netwrix', 'Stealthbits', 'Microsoft Purview', 'IBM Guardium', 'Imperva'],
                        remediation: [
                            'Implement data access governance solution (Varonis or Netwrix)',
                            'Configure role-based data access controls',
                            'Enable data access monitoring and auditing',
                            'Implement data access reviews and certifications',
                            'Set up anomaly detection for data access',
                            'Configure data access alerts and notifications'
                        ],
                        timeline: '3-5 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'Medium',
                        standards: ['CISA Data Pillar - Optimal Level', 'NIST 800-53 AC-3', 'GDPR'],
                        dependencies: ['Data classification', 'Directory services']
                    },
                    {
                        gap: 'No Data Backup and Recovery',
                        description: 'Inadequate or missing data backup and recovery capabilities, no disaster recovery plan.',
                        impact: 'Data loss risk, extended downtime, business continuity issues, compliance violations.',
                        tools: ['Veeam', 'Commvault', 'Rubrik', 'Cohesity', 'Azure Backup', 'AWS Backup'],
                        remediation: [
                            'Deploy enterprise backup solution (Veeam or Commvault recommended)',
                            'Implement automated backup schedules (3-2-1 rule)',
                            'Configure backup encryption and secure storage',
                            'Test backup and recovery procedures regularly',
                            'Establish disaster recovery (DR) plan',
                            'Set up offsite backup storage and replication'
                        ],
                        timeline: '2-4 months',
                        cost: '$$ (Medium)',
                        complexity: 'Low-Medium',
                        standards: ['ISO 27001 Business Continuity', 'CISA Data Pillar - Advanced Level'],
                        dependencies: ['Storage infrastructure', 'Network connectivity']
                    }
                ]
            },
            { 
                domain: 'Visibility & Analytics', 
                current: 'Basic logging, no SIEM, limited threat intelligence', 
                target: 'SIEM, behavioral analytics, threat intelligence, security orchestration', 
                gap: 'Missing SIEM, no behavioral analysis, limited threat intel', 
                priority: 'High', 
                gaps: 4,
                detailedGaps: [
                    {
                        gap: 'No Security Information and Event Management (SIEM)',
                        description: 'Lack of centralized security event collection, correlation, and analysis platform.',
                        impact: 'Inability to detect security incidents, slow threat response, limited security visibility, compliance gaps.',
                        tools: ['Splunk', 'Microsoft Sentinel', 'IBM QRadar', 'LogRhythm', 'Rapid7 InsightIDR', 'Exabeam'],
                        remediation: [
                            'Deploy SIEM solution (Microsoft Sentinel or Splunk recommended)',
                            'Configure log collection from all security sources',
                            'Implement security event correlation rules',
                            'Set up automated threat detection and alerting',
                            'Configure security dashboards and reporting',
                            'Establish security incident response workflows'
                        ],
                        timeline: '4-6 months',
                        cost: '$$$$ (High)',
                        complexity: 'High',
                        standards: ['CISA Visibility Domain - Advanced Level', 'Forrester Visibility & Analytics', 'NIST 800-53'],
                        dependencies: ['Log sources', 'Network infrastructure', 'Security tools integration']
                    },
                    {
                        gap: 'Missing Behavioral Analytics',
                        description: 'No user and entity behavior analytics (UEBA) to detect anomalous activities and insider threats.',
                        impact: 'Inability to detect insider threats, advanced persistent threats (APTs), account compromise, data exfiltration.',
                        tools: ['Exabeam', 'Securonix', 'Splunk UBA', 'Microsoft Sentinel UEBA', 'Varonis', 'Darktrace'],
                        remediation: [
                            'Deploy UEBA solution (Exabeam or Securonix recommended)',
                            'Configure baseline user and entity behavior profiles',
                            'Implement machine learning-based anomaly detection',
                            'Set up behavioral analytics dashboards',
                            'Configure automated threat detection and alerting',
                            'Integrate with SIEM for comprehensive visibility'
                        ],
                        timeline: '3-5 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'Medium',
                        standards: ['CISA Visibility Domain - Optimal Level', 'Forrester Visibility & Analytics'],
                        dependencies: ['SIEM platform', 'Data sources', 'Identity systems']
                    },
                    {
                        gap: 'Limited Threat Intelligence',
                        description: 'Lack of threat intelligence feeds, indicators of compromise (IOCs), and threat context.',
                        impact: 'Inability to detect known threats, slow threat response, limited threat awareness.',
                        tools: ['Recorded Future', 'CrowdStrike Falcon Intelligence', 'Mandiant Threat Intelligence', 'Anomali', 'ThreatConnect', 'MISP'],
                        remediation: [
                            'Subscribe to threat intelligence feeds (commercial and open source)',
                            'Deploy threat intelligence platform (Recorded Future or Anomali)',
                            'Integrate threat intel with SIEM and security tools',
                            'Configure IOC matching and alerting',
                            'Establish threat intelligence sharing processes',
                            'Set up threat hunting capabilities'
                        ],
                        timeline: '2-3 months',
                        cost: '$$ (Medium)',
                        complexity: 'Low-Medium',
                        standards: ['CISA Visibility Domain - Advanced Level', 'Forrester Visibility & Analytics'],
                        dependencies: ['SIEM platform', 'Security tools']
                    },
                    {
                        gap: 'No Security Orchestration, Automation, and Response (SOAR)',
                        description: 'Manual security incident response processes, no automation or orchestration capabilities.',
                        impact: 'Slow incident response, human errors, inconsistent processes, security team burnout.',
                        tools: ['Splunk Phantom', 'IBM Resilient', 'Rapid7 InsightConnect', 'Microsoft Sentinel Playbooks', 'Demisto', 'Swimlane'],
                        remediation: [
                            'Deploy SOAR platform (Microsoft Sentinel Playbooks or Splunk Phantom)',
                            'Document security incident response playbooks',
                            'Automate repetitive security tasks and workflows',
                            'Integrate security tools for orchestrated response',
                            'Implement automated threat containment and remediation',
                            'Set up security metrics and reporting'
                        ],
                        timeline: '4-6 months',
                        cost: '$$$ (Medium-High)',
                        complexity: 'High',
                        standards: ['CISA Visibility Domain - Optimal Level', 'NIST Cybersecurity Framework'],
                        dependencies: ['SIEM platform', 'Security tools', 'Incident response processes']
                    }
                ]
            }
        ];

        // Security Layer Data with detailed findings
        const securityLayerData = [
            { 
                layer: 'Perimeter Security', 
                status: 'Partially Implemented', 
                percentage: 60, 
                issues: 3, 
                priority: 'High',
                findings: [
                    { issue: 'Firewall rules not optimized', description: 'Many firewall rules are overly permissive, allowing unnecessary traffic flows', impact: 'Increased attack surface, potential for lateral movement', recommendation: 'Review and tighten firewall rules, implement least privilege access' },
                    { issue: 'Missing DDoS protection', description: 'No dedicated DDoS mitigation service or protection at network edge', impact: 'Vulnerable to DDoS attacks causing service disruption', recommendation: 'Deploy DDoS protection service (Cloudflare, Akamai, or AWS Shield)' },
                    { issue: 'Incomplete VPN security', description: 'VPN infrastructure lacks modern security controls and monitoring', impact: 'Potential unauthorized access through VPN, limited visibility', recommendation: 'Upgrade VPN to zero trust network access (ZTNA) solution' }
                ],
                tools: ['Palo Alto Firewalls', 'Fortinet Firewalls', 'Cisco ASA', 'Cloudflare', 'Akamai', 'AWS Shield'],
                standards: ['NIST 800-53 SC-7', 'CISA Networks Pillar', 'ISO 27001 Network Security']
            },
            { 
                layer: 'Identity & Access Layer', 
                status: 'Needs Improvement', 
                percentage: 35, 
                issues: 5, 
                priority: 'Critical',
                findings: [
                    { issue: 'No Multi-Factor Authentication', description: 'All user accounts rely solely on username/password authentication', impact: 'High risk of credential theft and unauthorized access', recommendation: 'Implement MFA for all users (Okta, Azure AD, or Duo)' },
                    { issue: 'Missing Identity Governance', description: 'No centralized identity governance, access certification, or RBAC framework', impact: 'Orphaned accounts, excessive permissions, compliance violations', recommendation: 'Deploy identity governance platform (SailPoint or CyberArk)' },
                    { issue: 'No Single Sign-On', description: 'Users authenticate separately to each application', impact: 'Password fatigue, security risks, poor user experience', recommendation: 'Implement SSO solution (Okta or Azure AD SSO)' },
                    { issue: 'Weak Privileged Access Management', description: 'Administrative accounts lack specialized security controls', impact: 'High risk of privilege escalation and insider threats', recommendation: 'Deploy PAM solution (CyberArk or BeyondTrust)' },
                    { issue: 'Inadequate Password Policies', description: 'Password policies do not meet industry standards', impact: 'Vulnerable to brute force and password cracking attacks', recommendation: 'Enforce strong password policies and enable password breach detection' }
                ],
                tools: ['Okta', 'Azure AD', 'Microsoft Entra ID', 'SailPoint', 'CyberArk', 'Duo Security'],
                standards: ['NIST 800-63B', 'CISA Identity Pillar', 'ISO 27001 Access Control']
            },
            { 
                layer: 'Network Layer', 
                status: 'Needs Improvement', 
                percentage: 45, 
                issues: 4, 
                priority: 'High',
                findings: [
                    { issue: 'No Micro-segmentation', description: 'Network relies on traditional VLAN-based segmentation', impact: 'Compromised device can access entire network segment', recommendation: 'Implement micro-segmentation (Illumio or Guardicore)' },
                    { issue: 'Missing Software-Defined Perimeter', description: 'Traditional VPN-based remote access with broad network access', impact: 'Over-privileged remote access, VPN vulnerabilities', recommendation: 'Deploy SDP solution (Zscaler ZPA or Cloudflare Access)' },
                    { issue: 'No Network Policy Automation', description: 'Network security policies manually configured and managed', impact: 'Policy misconfigurations, slow deployment, human errors', recommendation: 'Implement network policy automation (Cisco DNA Center or VMware NSX)' },
                    { issue: 'Insufficient Network Monitoring', description: 'Limited network visibility and traffic analysis', impact: 'Inability to detect network anomalies and threats', recommendation: 'Deploy NDR solution (ExtraHop, Darktrace, or Vectra AI)' }
                ],
                tools: ['Illumio', 'Guardicore', 'VMware NSX', 'Cisco ACI', 'Zscaler ZPA', 'Cloudflare Access'],
                standards: ['NIST 800-207', 'CISA Networks Pillar', 'Forrester Network Domain']
            },
            { 
                layer: 'Endpoint Security', 
                status: 'Partially Implemented', 
                percentage: 55, 
                issues: 3, 
                priority: 'High',
                findings: [
                    { issue: 'No Endpoint Detection and Response', description: 'Lack of advanced endpoint security beyond basic antivirus', impact: 'Inability to detect advanced threats, slow incident response', recommendation: 'Deploy EDR solution (CrowdStrike Falcon or SentinelOne)' },
                    { issue: 'Missing Device Health Attestation', description: 'No capability to verify device security posture before network access', impact: 'Compromised or non-compliant devices can access network', recommendation: 'Implement device compliance policies and health checks' },
                    { issue: 'Incomplete Mobile Device Management', description: 'Limited or no management controls for mobile devices', impact: 'Unmanaged mobile devices accessing corporate resources', recommendation: 'Deploy MDM solution (Microsoft Intune or VMware Workspace ONE)' }
                ],
                tools: ['CrowdStrike Falcon', 'SentinelOne', 'Microsoft Defender for Endpoint', 'Microsoft Intune', 'VMware Workspace ONE'],
                standards: ['CISA Devices Pillar', 'Forrester Device Domain', 'MITRE ATT&CK']
            },
            { 
                layer: 'Application Security', 
                status: 'Needs Improvement', 
                percentage: 30, 
                issues: 4, 
                priority: 'Critical',
                findings: [
                    { issue: 'No Application-Level Access Controls', description: 'Applications rely solely on network perimeter security', impact: 'Over-privileged application access, inability to enforce least privilege', recommendation: 'Implement application-level IAM and RBAC' },
                    { issue: 'Missing API Security', description: 'APIs lack proper authentication, authorization, and rate limiting', impact: 'API vulnerabilities, data exposure, unauthorized access', recommendation: 'Deploy API gateway solution (Kong or Apigee)' },
                    { issue: 'No Web Application Firewall', description: 'Web applications lack specialized protection against web-based attacks', impact: 'Vulnerable to OWASP Top 10 attacks, SQL injection, XSS', recommendation: 'Deploy WAF solution (Cloudflare WAF or AWS WAF)' },
                    { issue: 'Missing Application Security Testing', description: 'No automated security testing in CI/CD pipeline', impact: 'Vulnerable code deployed to production, security issues discovered late', recommendation: 'Integrate SAST/DAST into CI/CD pipeline (Veracode or Checkmarx)' }
                ],
                tools: ['Kong API Gateway', 'Apigee', 'AWS WAF', 'Cloudflare WAF', 'Veracode', 'Checkmarx'],
                standards: ['OWASP Top 10', 'CISA Applications Pillar', 'Forrester Workload Domain']
            },
            { 
                layer: 'Data Security', 
                status: 'Critical Gaps', 
                percentage: 25, 
                issues: 5, 
                priority: 'Critical',
                findings: [
                    { issue: 'No Encryption at Rest', description: 'Data stored in databases and file systems lacks encryption', impact: 'Data breach risk, compliance violations (GDPR, HIPAA)', recommendation: 'Implement database and file system encryption (AWS KMS, Azure Key Vault)' },
                    { issue: 'Missing Data Classification Framework', description: 'No systematic approach to classify data based on sensitivity', impact: 'Inability to apply appropriate security controls, compliance gaps', recommendation: 'Deploy data classification solution (Microsoft Purview or Varonis)' },
                    { issue: 'No Data Loss Prevention', description: 'Lack of controls to prevent unauthorized data exfiltration', impact: 'Data leakage risks, insider threats, compliance violations', recommendation: 'Deploy DLP solution (Microsoft Purview DLP or Forcepoint DLP)' },
                    { issue: 'Insufficient Data Access Controls', description: 'Lack of fine-grained access controls for data', impact: 'Over-privileged data access, unauthorized data access', recommendation: 'Implement data access governance (Varonis or Netwrix)' },
                    { issue: 'No Data Backup and Recovery', description: 'Inadequate or missing data backup and recovery capabilities', impact: 'Data loss risk, extended downtime, business continuity issues', recommendation: 'Deploy enterprise backup solution (Veeam or Commvault)' }
                ],
                tools: ['Microsoft Purview', 'Varonis', 'Forcepoint DLP', 'AWS KMS', 'Azure Key Vault', 'Veeam'],
                standards: ['NIST 800-175B', 'CISA Data Pillar', 'Forrester Data Domain', 'GDPR', 'HIPAA']
            },
            { 
                layer: 'Monitoring & Detection', 
                status: 'Needs Improvement', 
                percentage: 40, 
                issues: 4, 
                priority: 'High',
                findings: [
                    { issue: 'No Security Information and Event Management', description: 'Lack of centralized security event collection and analysis', impact: 'Inability to detect security incidents, slow threat response', recommendation: 'Deploy SIEM solution (Microsoft Sentinel or Splunk)' },
                    { issue: 'Missing Behavioral Analytics', description: 'No user and entity behavior analytics (UEBA)', impact: 'Inability to detect insider threats, APTs, account compromise', recommendation: 'Deploy UEBA solution (Exabeam or Securonix)' },
                    { issue: 'Limited Threat Intelligence', description: 'Lack of threat intelligence feeds and indicators of compromise', impact: 'Inability to detect known threats, slow threat response', recommendation: 'Subscribe to threat intelligence feeds (Recorded Future or Anomali)' },
                    { issue: 'No Security Orchestration and Automation', description: 'Manual security incident response processes', impact: 'Slow incident response, human errors, inconsistent processes', recommendation: 'Deploy SOAR platform (Microsoft Sentinel Playbooks or Splunk Phantom)' }
                ],
                tools: ['Microsoft Sentinel', 'Splunk', 'Exabeam', 'Securonix', 'Recorded Future', 'Anomali'],
                standards: ['CISA Visibility Domain', 'Forrester Visibility & Analytics', 'NIST 800-53']
            },
            { 
                layer: 'Incident Response', 
                status: 'Partially Implemented', 
                percentage: 50, 
                issues: 3, 
                priority: 'High',
                findings: [
                    { issue: 'No Formal Incident Response Plan', description: 'Lack of documented and tested incident response procedures', impact: 'Inconsistent response, delayed containment, increased damage', recommendation: 'Develop and document incident response plan (NIST SP 800-61)' },
                    { issue: 'Missing Incident Response Team', description: 'No dedicated or trained incident response team', impact: 'Slow response times, lack of expertise, increased recovery time', recommendation: 'Establish incident response team with defined roles and responsibilities' },
                    { issue: 'No Security Orchestration', description: 'Manual incident response processes without automation', impact: 'Slow response, human errors, security team burnout', recommendation: 'Deploy SOAR platform to automate incident response workflows' }
                ],
                tools: ['Microsoft Sentinel Playbooks', 'Splunk Phantom', 'IBM Resilient', 'Rapid7 InsightConnect'],
                standards: ['NIST SP 800-61', 'ISO 27035', 'CISA Visibility Domain']
            }
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeStep1();
        });

        function proceedToStep(step) {
            // Hide current step
            document.querySelector(`#step${currentStep}`).classList.remove('active');
            document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
            
            // Mark previous step as completed
            if (step > currentStep) {
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('completed');
            }
            
            // Show new step
            currentStep = step;
            document.querySelector(`#step${currentStep}`).classList.add('active');
            document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
            
            // Initialize step-specific content
            if (step === 1) initializeStep1();
            else if (step === 2) initializeStep2();
            else if (step === 3) initializeStep3();
            else if (step === 4) initializeStep4();
            else if (step === 5) initializeStep5();
            else if (step === 6) initializeStep6();
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function initializeStep1() {
            // Simulate loading devices
            setTimeout(() => {
                document.getElementById('loadingStatus').textContent = '‚úì Successfully loaded device inventory';
                document.getElementById('loadingSpinner').style.display = 'none';
                document.getElementById('deviceCount').textContent = `‚úì Loaded ${enterpriseDevices.length} devices from Graph Database`;
                document.getElementById('totalDevices').textContent = enterpriseDevices.length;
                
                // Populate device table
                const tbody = document.getElementById('deviceTableBody');
                tbody.innerHTML = '';
                enterpriseDevices.forEach(device => {
                    const row = tbody.insertRow();
                    row.innerHTML = `
                        <td>${device.name}</td>
                        <td>${device.type}</td>
                        <td>${device.ip}</td>
                        <td>${device.location}</td>
                        <td>${device.os}</td>
                        <td><span class="badge badge-success">${device.status}</span></td>
                    `;
                });
                
                // Draw topology
                drawTopology();
            }, 1500);
        }

        function drawTopology() {
            const container = document.getElementById('topologyVisualization');
            container.innerHTML = '';
            container.style.width = '100%';
            container.style.height = '800px';
            container.style.position = 'relative';
            
            // Define network architecture zones and devices
            const architecture = {
                internet: { x: 400, y: 20, width: 200, height: 60 },
                dmz: { x: 50, y: 100, width: 900, height: 120 },
                core: { x: 50, y: 240, width: 900, height: 180 },
                distribution: { x: 50, y: 440, width: 900, height: 200 },
                access: { x: 50, y: 660, width: 900, height: 120 }
            };

            // Draw network layers
            Object.keys(architecture).forEach((layer, idx) => {
                const layerDiv = document.createElement('div');
                layerDiv.className = 'network-layer';
                layerDiv.style.left = architecture[layer].x + 'px';
                layerDiv.style.top = architecture[layer].y + 'px';
                layerDiv.style.width = architecture[layer].width + 'px';
                layerDiv.style.height = architecture[layer].height + 'px';
                container.appendChild(layerDiv);

                const label = document.createElement('div');
                label.className = 'network-layer-label';
                label.textContent = layer.toUpperCase();
                label.style.left = (architecture[layer].x + 10) + 'px';
                label.style.top = (architecture[layer].y - 12) + 'px';
                container.appendChild(label);
            });

            // Internet Gateway
            const internetZone = document.createElement('div');
            internetZone.className = 'network-zone';
            internetZone.style.left = architecture.internet.x + 'px';
            internetZone.style.top = architecture.internet.y + 'px';
            internetZone.style.width = architecture.internet.width + 'px';
            internetZone.style.height = architecture.internet.height + 'px';
            const internetLabel = document.createElement('div');
            internetLabel.className = 'network-zone-label';
            internetLabel.textContent = 'Internet';
            internetLabel.style.color = '#EF4444';
            internetZone.appendChild(internetLabel);
            container.appendChild(internetZone);

            // DMZ Zone
            const dmzZone = document.createElement('div');
            dmzZone.className = 'network-zone dmz';
            dmzZone.style.left = architecture.dmz.x + 'px';
            dmzZone.style.top = architecture.dmz.y + 'px';
            dmzZone.style.width = architecture.dmz.width + 'px';
            dmzZone.style.height = architecture.dmz.height + 'px';
            const dmzLabel = document.createElement('div');
            dmzLabel.className = 'network-zone-label';
            dmzLabel.textContent = 'DMZ Zone';
            dmzLabel.style.color = '#EF4444';
            dmzZone.appendChild(dmzLabel);
            container.appendChild(dmzZone);

            // DMZ Devices
            const dmzDevices = [
                { type: 'firewall', name: 'FW-DMZ-01', x: 150, y: 140 },
                { type: 'firewall', name: 'FW-DMZ-02', x: 250, y: 140 },
                { type: 'loadbalancer', name: 'LB-WEB-01', x: 400, y: 140 },
                { type: 'loadbalancer', name: 'LB-WEB-02', x: 500, y: 140 },
                { type: 'server', name: 'WEB-01', x: 650, y: 140 },
                { type: 'server', name: 'WEB-02', x: 750, y: 140 },
                { type: 'server', name: 'WEB-03', x: 850, y: 140 }
            ];

            dmzDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.dmz.x + device.x, architecture.dmz.y + device.y);
                container.appendChild(dev);
            });

            // Core Network Zone
            const coreZone = document.createElement('div');
            coreZone.className = 'network-zone internal';
            coreZone.style.left = architecture.core.x + 'px';
            coreZone.style.top = architecture.core.y + 'px';
            coreZone.style.width = architecture.core.width + 'px';
            coreZone.style.height = architecture.core.height + 'px';
            const coreLabel = document.createElement('div');
            coreLabel.className = 'network-zone-label';
            coreLabel.textContent = 'Core Network';
            coreLabel.style.color = '#2563EB';
            coreZone.appendChild(coreLabel);
            container.appendChild(coreZone);

            // Core Devices
            const coreDevices = [
                { type: 'router', name: 'CORE-RTR-01', x: 100, y: 280 },
                { type: 'router', name: 'CORE-RTR-02', x: 200, y: 280 },
                { type: 'switch', name: 'CORE-SW-01', x: 350, y: 280 },
                { type: 'switch', name: 'CORE-SW-02', x: 450, y: 280 },
                { type: 'firewall', name: 'FW-INT-01', x: 600, y: 280 },
                { type: 'firewall', name: 'FW-INT-02', x: 700, y: 280 },
                { type: 'loadbalancer', name: 'LB-APP-01', x: 800, y: 280 }
            ];

            coreDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.core.x + device.x, architecture.core.y + device.y);
                container.appendChild(dev);
            });

            // Distribution Layer
            const distDevices = [
                { type: 'switch', name: 'DIST-SW-01', x: 100, y: 480 },
                { type: 'switch', name: 'DIST-SW-02', x: 250, y: 480 },
                { type: 'switch', name: 'DIST-SW-03', x: 400, y: 480 },
                { type: 'switch', name: 'DIST-SW-04', x: 550, y: 480 },
                { type: 'switch', name: 'DIST-SW-05', x: 700, y: 480 },
                { type: 'switch', name: 'DIST-SW-06', x: 850, y: 480 }
            ];

            distDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.distribution.x + device.x, architecture.distribution.y + device.y);
                container.appendChild(dev);
            });

            // Management Zone
            const mgmtZone = document.createElement('div');
            mgmtZone.className = 'network-zone management';
            mgmtZone.style.left = architecture.distribution.x + 50 + 'px';
            mgmtZone.style.top = architecture.distribution.y + 60 + 'px';
            mgmtZone.style.width = 200 + 'px';
            mgmtZone.style.height = 120 + 'px';
            const mgmtLabel = document.createElement('div');
            mgmtLabel.className = 'network-zone-label';
            mgmtLabel.textContent = 'Management';
            mgmtLabel.style.color = '#10B981';
            mgmtZone.appendChild(mgmtLabel);
            container.appendChild(mgmtZone);

            const mgmtDevices = [
                { type: 'server', name: 'AD-DC-01', x: 70, y: 540 },
                { type: 'server', name: 'AD-DC-02', x: 170, y: 540 },
                { type: 'server', name: 'FILE-01', x: 70, y: 580 },
                { type: 'server', name: 'EXCH-01', x: 170, y: 580 }
            ];

            mgmtDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.distribution.x + device.x, architecture.distribution.y + device.y);
                container.appendChild(dev);
            });

            // Data Zone
            const dataZone = document.createElement('div');
            dataZone.className = 'network-zone data';
            dataZone.style.left = architecture.distribution.x + 300 + 'px';
            dataZone.style.top = architecture.distribution.y + 60 + 'px';
            dataZone.style.width = 200 + 'px';
            dataZone.style.height = 120 + 'px';
            const dataLabel = document.createElement('div');
            dataLabel.className = 'network-zone-label';
            dataLabel.textContent = 'Data Layer';
            dataLabel.style.color = '#8B5CF6';
            dataZone.appendChild(dataLabel);
            container.appendChild(dataZone);

            const dataDevices = [
                { type: 'server', name: 'DB-01', x: 320, y: 540 },
                { type: 'server', name: 'DB-02', x: 420, y: 540 },
                { type: 'server', name: 'DB-03', x: 320, y: 580 },
                { type: 'server', name: 'DB-04', x: 420, y: 580 }
            ];

            dataDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.distribution.x + device.x, architecture.distribution.y + device.y);
                container.appendChild(dev);
            });

            // Application Zone
            const appZone = document.createElement('div');
            appZone.className = 'network-zone internal';
            appZone.style.left = architecture.distribution.x + 550 + 'px';
            appZone.style.top = architecture.distribution.y + 60 + 'px';
            appZone.style.width = 200 + 'px';
            appZone.style.height = 120 + 'px';
            const appLabel = document.createElement('div');
            appLabel.className = 'network-zone-label';
            appLabel.textContent = 'Application';
            appLabel.style.color = '#2563EB';
            appZone.appendChild(appLabel);
            container.appendChild(appZone);

            const appDevices = [
                { type: 'server', name: 'APP-01', x: 570, y: 540 },
                { type: 'server', name: 'APP-02', x: 670, y: 540 },
                { type: 'server', name: 'APP-03', x: 570, y: 580 },
                { type: 'server', name: 'APP-04', x: 670, y: 580 }
            ];

            appDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.distribution.x + device.x, architecture.distribution.y + device.y);
                container.appendChild(dev);
            });

            // Access Layer
            const accessDevices = [
                { type: 'switch', name: 'ACC-SW-01', x: 100, y: 700 },
                { type: 'switch', name: 'ACC-SW-02', x: 250, y: 700 },
                { type: 'switch', name: 'ACC-SW-03', x: 400, y: 700 },
                { type: 'wifi', name: 'WIFI-CTRL', x: 550, y: 700 },
                { type: 'switch', name: 'ACC-SW-04', x: 700, y: 700 },
                { type: 'switch', name: 'ACC-SW-05', x: 850, y: 700 }
            ];

            accessDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.access.x + device.x, architecture.access.y + device.y);
                container.appendChild(dev);
            });

            // Draw connections
            drawConnections(container, architecture, dmzDevices, coreDevices, distDevices, accessDevices);
        }

        function createDevice(type, name, x, y) {
            const device = document.createElement('div');
            device.className = `network-device ${type}`;
            device.style.left = x + 'px';
            device.style.top = y + 'px';
            device.innerHTML = `
                <div style="font-weight: 600; font-size: 10px; margin-bottom: 4px;">${getDeviceIcon(type)}</div>
                <div style="font-size: 9px; color: var(--text-secondary);">${name}</div>
            `;
            device.title = `${name} - ${type.toUpperCase()}`;
            return device;
        }

        function getDeviceIcon(type) {
            const icons = {
                firewall: 'üõ°Ô∏è',
                switch: 'üîÄ',
                router: 'üåê',
                loadbalancer: '‚öñÔ∏è',
                server: 'üíª',
                wifi: 'üì∂'
            };
            return icons[type] || 'üì¶';
        }

        function drawConnections(container, architecture, dmzDevices, coreDevices, distDevices, accessDevices) {
            // Internet to DMZ Firewalls
            drawLine(container, architecture.internet.x + 100, architecture.internet.y + 60, architecture.dmz.x + 150, architecture.dmz.y + 20, 'critical');
            drawLine(container, architecture.internet.x + 100, architecture.internet.y + 60, architecture.dmz.x + 250, architecture.dmz.y + 20, 'critical');

            // DMZ to Core
            drawLine(container, architecture.dmz.x + 400, architecture.dmz.y + 120, architecture.core.x + 350, architecture.core.y + 20, 'critical');
            drawLine(container, architecture.dmz.x + 500, architecture.dmz.y + 120, architecture.core.x + 450, architecture.core.y + 20, 'critical');

            // Core to Distribution
            coreDevices.forEach((coreDev, idx) => {
                if (idx < distDevices.length) {
                    drawLine(container, 
                        architecture.core.x + coreDev.x + 50, architecture.core.y + coreDev.y + 30,
                        architecture.distribution.x + distDevices[idx].x + 50, architecture.distribution.y + distDevices[idx].y + 10,
                        idx % 2 === 0 ? 'normal' : 'redundant'
                    );
                }
            });

            // Distribution to Access
            distDevices.forEach((distDev, idx) => {
                if (idx < accessDevices.length) {
                    drawLine(container,
                        architecture.distribution.x + distDev.x + 50, architecture.distribution.y + distDev.y + 30,
                        architecture.access.x + accessDevices[idx].x + 50, architecture.access.y + accessDevices[idx].y + 10,
                        'normal'
                    );
                }
            });

            // Redundant connections in core
            drawLine(container, architecture.core.x + 350, architecture.core.y + 90, architecture.core.x + 450, architecture.core.y + 90, 'redundant');
            drawLine(container, architecture.core.x + 600, architecture.core.y + 90, architecture.core.x + 700, architecture.core.y + 90, 'redundant');
        }

        function drawLine(container, x1, y1, x2, y2, type) {
            const line = document.createElement('div');
            line.className = `network-connection-line ${type}`;
            const length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
            const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
            line.style.width = length + 'px';
            line.style.left = x1 + 'px';
            line.style.top = y1 + 'px';
            line.style.transform = `rotate(${angle}deg)`;
            line.style.transformOrigin = '0 0';
            container.appendChild(line);
        }

        // Helper function to generate CISA modal content
        function generateCISAModalContent(data) {
            return `
                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üìä Overview</h6>
                    <table style="width: 100%;">
                        <tr><td style="width: 30%; font-weight: 600; padding: 8px 0;">Pillar:</td><td style="padding: 8px 0;">${data.pillar}</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Current Maturity:</td><td style="padding: 8px 0;">${data.current}</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Maturity Level:</td><td style="padding: 8px 0;">${data.percentage}%</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Target Maturity:</td><td style="padding: 8px 0;">${data.target}</td></tr>
                    </table>
                </div>

                <div style="margin-bottom: 20px;">
                    <strong style="color: var(--dark-bg); font-size: 16px;">Description:</strong>
                    <p style="color: var(--text-secondary); margin: 8px 0 0 0; line-height: 1.6;">${data.description}</p>
                </div>

                <div style="margin-bottom: 20px;">
                    <strong style="color: var(--dark-bg); font-size: 16px; margin-bottom: 12px; display: block;">Target Capabilities:</strong>
                    <ul style="margin-left: 20px; line-height: 2; color: var(--text-secondary);">
                        ${data.capabilities.map(cap => `<li>${cap}</li>`).join('')}
                    </ul>
                </div>

                <div style="margin-bottom: 20px;">
                    <strong style="color: var(--dark-bg); font-size: 16px; margin-bottom: 12px; display: block;">Current Gaps:</strong>
                    <ul style="margin-left: 20px; line-height: 2; color: var(--text-secondary);">
                        ${data.gaps.map(gap => `<li>${gap}</li>`).join('')}
                    </ul>
                </div>

                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üõ†Ô∏è Recommended Tools</h6>
                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                        ${data.tools.map(tool => `<span class="badge badge-info" style="font-size: 12px;">${tool}</span>`).join('')}
                    </div>
                </div>

                <div style="background: #FEF3C7; padding: 12px; border-radius: 6px; margin-bottom: 16px; border-left: 3px solid var(--warning-orange);">
                    <strong style="color: #92400E; font-size: 12px;">üìã Standards & Compliance References:</strong>
                    <p style="margin: 4px 0 0 0; color: #78350F; font-size: 12px;">${data.standards.join(', ')}</p>
                </div>

                <div style="background: #D1FAE5; padding: 12px; border-radius: 6px; border-left: 3px solid #10B981;">
                    <strong style="color: #065F46; font-size: 12px;">üó∫Ô∏è Implementation Roadmap:</strong>
                    <p style="margin: 4px 0 0 0; color: #047857; font-size: 14px; font-weight: 600;">${data.roadmap}</p>
                </div>
            `;
        }

        // Helper function to generate Forrester modal content
        function generateForresterModalContent(data) {
            return `
                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üìä Overview</h6>
                    <table style="width: 100%;">
                        <tr><td style="width: 30%; font-weight: 600; padding: 8px 0;">Domain:</td><td style="padding: 8px 0;">${data.domain}</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Maturity Score:</td><td style="padding: 8px 0;">${data.score}/5</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Maturity Level:</td><td style="padding: 8px 0;">${data.percentage}%</td></tr>
                    </table>
                </div>

                <div style="margin-bottom: 20px;">
                    <strong style="color: var(--dark-bg); font-size: 16px;">Description:</strong>
                    <p style="color: var(--text-secondary); margin: 8px 0 0 0; line-height: 1.6;">${data.description}</p>
                </div>

                <div style="margin-bottom: 20px;">
                    <strong style="color: var(--dark-bg); font-size: 16px; margin-bottom: 12px; display: block;">Target Capabilities:</strong>
                    <ul style="margin-left: 20px; line-height: 2; color: var(--text-secondary);">
                        ${data.capabilities.map(cap => `<li>${cap}</li>`).join('')}
                    </ul>
                </div>

                <div style="margin-bottom: 20px;">
                    <strong style="color: var(--dark-bg); font-size: 16px; margin-bottom: 12px; display: block;">Current Gaps:</strong>
                    <ul style="margin-left: 20px; line-height: 2; color: var(--text-secondary);">
                        ${data.gaps.map(gap => `<li>${gap}</li>`).join('')}
                    </ul>
                </div>

                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üõ†Ô∏è Recommended Tools</h6>
                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                        ${data.tools.map(tool => `<span class="badge badge-info" style="font-size: 12px;">${tool}</span>`).join('')}
                    </div>
                </div>

                <div style="background: #FEF3C7; padding: 12px; border-radius: 6px; border-left: 3px solid var(--warning-orange);">
                    <strong style="color: #92400E; font-size: 12px;">üìã Standards & Compliance References:</strong>
                    <p style="margin: 4px 0 0 0; color: #78350F; font-size: 12px;">${data.standards.join(', ')}</p>
                </div>
            `;
        }

        // Helper function to generate Gap Analysis modal content
        function generateGapAnalysisModalContent(data) {
            return `
                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üìä Overview</h6>
                    <table style="width: 100%;">
                        <tr><td style="width: 30%; font-weight: 600; padding: 8px 0;">Domain:</td><td style="padding: 8px 0;">${data.domain}</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Current State:</td><td style="padding: 8px 0;">${data.current}</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Target State:</td><td style="padding: 8px 0;">${data.target}</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Priority:</td><td style="padding: 8px 0;"><span class="badge ${data.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}">${data.priority}</span></td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Total Gaps:</td><td style="padding: 8px 0;">${data.gaps} gaps identified</td></tr>
                    </table>
                </div>

                ${data.detailedGaps ? data.detailedGaps.map((detailedGap, gapIndex) => `
                    <div style="background: white; border: 2px solid ${data.priority === 'Critical' ? '#EF4444' : '#F59E0B'}; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                            <h6 style="margin: 0; color: var(--dark-bg); font-size: 18px;">Gap ${gapIndex + 1}: ${detailedGap.gap}</h6>
                            <span class="badge ${data.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}">${data.priority}</span>
                        </div>
                        
                        <div style="margin-bottom: 16px;">
                            <strong style="color: var(--dark-bg);">Description:</strong>
                            <p style="color: var(--text-secondary); margin: 8px 0 0 0; line-height: 1.6;">${detailedGap.description}</p>
                        </div>

                        <div style="margin-bottom: 16px;">
                            <strong style="color: var(--dark-bg);">Business Impact:</strong>
                            <p style="color: var(--text-secondary); margin: 8px 0 0 0; line-height: 1.6;">${detailedGap.impact}</p>
                        </div>

                        <div style="margin-bottom: 16px;">
                            <strong style="color: var(--dark-bg); margin-bottom: 8px; display: block;">Recommended Tools:</strong>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                ${detailedGap.tools.map(tool => `<span class="badge badge-info" style="font-size: 12px;">${tool}</span>`).join('')}
                            </div>
                            <p style="color: var(--text-secondary); margin-top: 8px; font-size: 12px; font-style: italic;">Recommended: ${detailedGap.tools[0]} or ${detailedGap.tools[1]}</p>
                        </div>

                        <div style="margin-bottom: 16px;">
                            <strong style="color: var(--dark-bg); margin-bottom: 8px; display: block;">Remediation Steps:</strong>
                            <ol style="margin: 8px 0 0 0; padding-left: 24px; color: var(--text-secondary); line-height: 1.8;">
                                ${detailedGap.remediation.map(step => `<li>${step}</li>`).join('')}
                            </ol>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 16px;">
                            <div style="background: #F9FAFB; padding: 12px; border-radius: 6px;">
                                <strong style="color: var(--dark-bg); font-size: 12px;">Timeline:</strong>
                                <p style="margin: 4px 0 0 0; color: var(--text-secondary); font-size: 14px; font-weight: 600;">${detailedGap.timeline}</p>
                            </div>
                            <div style="background: #F9FAFB; padding: 12px; border-radius: 6px;">
                                <strong style="color: var(--dark-bg); font-size: 12px;">Estimated Cost:</strong>
                                <p style="margin: 4px 0 0 0; color: var(--text-secondary); font-size: 14px; font-weight: 600;">${detailedGap.cost}</p>
                            </div>
                            <div style="background: #F9FAFB; padding: 12px; border-radius: 6px;">
                                <strong style="color: var(--dark-bg); font-size: 12px;">Complexity:</strong>
                                <p style="margin: 4px 0 0 0; color: var(--text-secondary); font-size: 14px; font-weight: 600;">${detailedGap.complexity}</p>
                            </div>
                            <div style="background: #F9FAFB; padding: 12px; border-radius: 6px;">
                                <strong style="color: var(--dark-bg); font-size: 12px;">Dependencies:</strong>
                                <p style="margin: 4px 0 0 0; color: var(--text-secondary); font-size: 12px;">${detailedGap.dependencies.join(', ')}</p>
                            </div>
                        </div>

                        <div style="background: #FEF3C7; padding: 12px; border-radius: 6px; border-left: 3px solid var(--warning-orange);">
                            <strong style="color: #92400E; font-size: 12px;">Standards & Compliance References:</strong>
                            <p style="margin: 4px 0 0 0; color: #78350F; font-size: 12px;">${detailedGap.standards.join(', ')}</p>
                        </div>
                    </div>
                `).join('') : ''}
            `;
        }

        // Helper function to generate Roadmap Phase modal content
        function generateRoadmapPhaseModalContent(phase) {
            return `
                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üìä Phase Overview</h6>
                    <table style="width: 100%;">
                        <tr><td style="width: 30%; font-weight: 600; padding: 8px 0;">Phase:</td><td style="padding: 8px 0;">${phase.name}</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Timeline:</td><td style="padding: 8px 0;">${phase.date || phase.timeline}</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Priority:</td><td style="padding: 8px 0;"><span class="badge ${phase.priority === 'critical' || phase.priority === 'Critical' ? 'badge-danger' : phase.priority === 'high' || phase.priority === 'High' ? 'badge-warning' : 'badge-info'}">${(phase.priority.charAt(0).toUpperCase() + phase.priority.slice(1))}</span></td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Initiatives:</td><td style="padding: 8px 0;">${phase.initiatives.length} key initiatives</td></tr>
                    </table>
                </div>

                <div style="margin-bottom: 20px;">
                    <strong style="color: var(--dark-bg); font-size: 16px;">Description:</strong>
                    <p style="color: var(--text-secondary); margin: 8px 0 0 0; line-height: 1.6;">${phase.description}</p>
                </div>

                <div style="margin-bottom: 20px;">
                    <strong style="color: var(--dark-bg); font-size: 16px; margin-bottom: 12px; display: block;">Key Initiatives:</strong>
                    <ul style="margin-left: 20px; line-height: 2.5; color: var(--text-secondary);">
                        ${phase.initiatives.map(init => `<li>${init}</li>`).join('')}
                    </ul>
                </div>

                <div style="background: #D1FAE5; padding: 12px; border-radius: 6px; border-left: 3px solid #10B981;">
                    <strong style="color: #065F46; font-size: 12px;">üí° Expected Outcomes:</strong>
                    <p style="margin: 4px 0 0 0; color: #047857; font-size: 14px;">${phase.expectedOutcomes || (phase.priority === 'critical' || phase.priority === 'Critical' ? 'Address critical security gaps, establish foundational Zero Trust capabilities, improve overall security posture by 30-40%' : phase.priority === 'high' || phase.priority === 'High' ? 'Enhance network security, implement advanced segmentation, improve threat detection capabilities' : 'Optimize security operations, achieve advanced maturity levels, establish continuous improvement processes')}</p>
                </div>
            `;
        }

        // Helper function to generate Security Layer modal content
        function generateSecurityLayerModalContent(data) {
            return `
                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üìä Overview</h6>
                    <table style="width: 100%;">
                        <tr><td style="width: 30%; font-weight: 600; padding: 8px 0;">Layer:</td><td style="padding: 8px 0;">${data.layer}</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Status:</td><td style="padding: 8px 0;">${data.status}</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Maturity Level:</td><td style="padding: 8px 0;">${data.percentage}%</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Priority:</td><td style="padding: 8px 0;"><span class="badge ${data.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}">${data.priority}</span></td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Total Issues:</td><td style="padding: 8px 0;">${data.issues} issues identified</td></tr>
                    </table>
                </div>

                <h6 style="margin: 30px 0 16px 0; color: var(--dark-bg); font-size: 18px;">üîç Detailed Findings</h6>
                ${data.findings ? data.findings.map((finding, findingIndex) => `
                    <div style="background: white; border: 2px solid ${data.priority === 'Critical' ? '#EF4444' : '#F59E0B'}; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                            <h6 style="margin: 0; color: var(--dark-bg); font-size: 18px;">Issue ${findingIndex + 1}: ${finding.issue}</h6>
                            <span class="badge ${data.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}">${data.priority}</span>
                        </div>
                        
                        <div style="margin-bottom: 16px;">
                            <strong style="color: var(--dark-bg);">Description:</strong>
                            <p style="color: var(--text-secondary); margin: 8px 0 0 0; line-height: 1.6;">${finding.description}</p>
                        </div>

                        <div style="margin-bottom: 16px;">
                            <strong style="color: var(--dark-bg);">Business Impact:</strong>
                            <p style="color: var(--text-secondary); margin: 8px 0 0 0; line-height: 1.6;">${finding.impact}</p>
                        </div>

                        <div style="background: #D1FAE5; padding: 12px; border-radius: 6px; border-left: 3px solid #10B981;">
                            <strong style="color: #065F46; font-size: 12px;">üí° Recommendation:</strong>
                            <p style="margin: 4px 0 0 0; color: #047857; font-size: 14px; font-weight: 600;">${finding.recommendation}</p>
                        </div>
                    </div>
                `).join('') : ''}

                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-top: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üõ†Ô∏è Recommended Tools</h6>
                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                        ${data.tools ? data.tools.map(tool => `<span class="badge badge-info" style="font-size: 12px;">${tool}</span>`).join('') : ''}
                    </div>
                </div>

                <div style="background: #FEF3C7; padding: 12px; border-radius: 6px; margin-top: 16px; border-left: 3px solid var(--warning-orange);">
                    <strong style="color: #92400E; font-size: 12px;">üìã Standards & Compliance References:</strong>
                    <p style="margin: 4px 0 0 0; color: #78350F; font-size: 12px;">${data.standards ? data.standards.join(', ') : ''}</p>
                </div>
            `;
        }

        // Helper function to generate consolidated modal content
        function generateConsolidatedModalContent(domainData) {
            const { domain, cisa, forrester, tools } = domainData;
            return `
                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üìä Domain Overview</h6>
                    <table style="width: 100%;">
                        <tr><td style="width: 30%; font-weight: 600; padding: 8px 0;">Domain:</td><td style="padding: 8px 0;">${domain}</td></tr>
                        ${cisa ? `<tr><td style="font-weight: 600; padding: 8px 0;">CISA Pillar:</td><td style="padding: 8px 0;">${cisa.pillar} (${cisa.current})</td></tr>` : ''}
                        ${forrester ? `<tr><td style="font-weight: 600; padding: 8px 0;">Forrester Domain:</td><td style="padding: 8px 0;">${forrester.domain} (Score: ${forrester.score}/5)</td></tr>` : ''}
                        <tr><td style="font-weight: 600; padding: 8px 0;">Combined Maturity:</td><td style="padding: 8px 0;">${domainData.combinedPercentage}%</td></tr>
                    </table>
                </div>

                ${cisa ? `
                <div style="margin-bottom: 20px;">
                    <strong style="color: var(--dark-bg); font-size: 16px; margin-bottom: 12px; display: block;">CISA ${cisa.pillar} Pillar Assessment:</strong>
                    <div style="background: #F9FAFB; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                        <p style="margin: 0 0 8px 0; color: var(--text-secondary); line-height: 1.6;">${cisa.description}</p>
                        <div style="margin-top: 12px;">
                            <strong style="font-size: 12px; color: var(--dark-bg);">Current Maturity:</strong> ${cisa.current} (${cisa.percentage}%)
                        </div>
                        <div style="margin-top: 8px;">
                            <strong style="font-size: 12px; color: var(--dark-bg);">Target Maturity:</strong> ${cisa.target}
                        </div>
                    </div>
                </div>
                ` : ''}

                ${forrester ? `
                <div style="margin-bottom: 20px;">
                    <strong style="color: var(--dark-bg); font-size: 16px; margin-bottom: 12px; display: block;">Forrester ${forrester.domain} Domain Assessment:</strong>
                    <div style="background: #F9FAFB; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                        <p style="margin: 0 0 8px 0; color: var(--text-secondary); line-height: 1.6;">${forrester.description}</p>
                        <div style="margin-top: 12px;">
                            <strong style="font-size: 12px; color: var(--dark-bg);">Maturity Score:</strong> ${forrester.score}/5 (${forrester.percentage}%)
                        </div>
                    </div>
                </div>
                ` : ''}

                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üõ†Ô∏è Recommended Tools for ${domain}</h6>
                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                        ${tools.map(tool => `<span class="badge badge-info" style="font-size: 12px;">${tool}</span>`).join('')}
                    </div>
                    <p style="margin-top: 12px; color: var(--text-secondary); font-size: 12px; font-style: italic;">Recommended: ${tools[0]} or ${tools[1]}</p>
                </div>

                ${cisa ? `
                <div style="background: #FEF3C7; padding: 12px; border-radius: 6px; margin-bottom: 16px; border-left: 3px solid var(--warning-orange);">
                    <strong style="color: #92400E; font-size: 12px;">üìã Standards & Compliance References:</strong>
                    <p style="margin: 4px 0 0 0; color: #78350F; font-size: 12px;">${cisa.standards.join(', ')}</p>
                </div>
                ` : ''}
            `;
        }

        function initializeStep2() {
            // Map CISA pillars to Forrester domains
            const domainMapping = {
                'Identity': { forrester: 'Workforce' },
                'Devices': { forrester: 'Device' },
                'Networks': { forrester: 'Network' },
                'Applications': { forrester: 'Workload' },
                'Data': { forrester: 'Data' }
            };

            // Tool mapping for each domain
            const toolMapping = {
                'Identity / Workforce': {
                    tools: ['Okta', 'Azure AD', 'Microsoft Entra ID', 'Duo Security', 'Authy', 'Google Authenticator', 'SailPoint', 'CyberArk', 'Ping Identity', 'ForgeRock', 'OneLogin', 'JumpCloud']
                },
                'Devices / Device': {
                    tools: ['Microsoft Intune', 'VMware Workspace ONE', 'Jamf Pro', 'CrowdStrike Falcon', 'SentinelOne', 'Tanium', 'Qualys VMDR', 'Nessus', 'Rapid7 InsightVM', 'Tenable.io']
                },
                'Networks / Network': {
                    tools: ['Cisco ACI', 'VMware NSX', 'Palo Alto Firewalls', 'Fortinet Firewalls', 'Zscaler ZPA', 'Cloudflare Access', 'VeloCloud SD-WAN', 'Versa Networks', 'Cato Networks', 'Perimeter 81']
                },
                'Applications / Workload': {
                    tools: ['AWS WAF', 'Azure Application Gateway', 'F5 BIG-IP', 'NGINX Plus', 'Kong API Gateway', 'Apigee', 'Prisma Cloud', 'Aqua Security', 'Twistlock', 'Sysdig Secure']
                },
                'Data': {
                    tools: ['Microsoft Purview', 'Varonis', 'Forcepoint DLP', 'Symantec DLP', 'Digital Guardian', 'McAfee DLP', 'Proofpoint DLP', 'Titus', 'Boldon James', 'Seclore']
                },
                'Workplace': {
                    tools: ['VMware Workspace ONE', 'Citrix Workspace', 'Microsoft 365', 'Google Workspace', 'Slack Enterprise Grid', 'Zoom', 'Microsoft Teams', 'Cisco Webex']
                },
                'Visibility & Analytics': {
                    tools: ['Splunk', 'Datadog', 'New Relic', 'Elastic Security', 'IBM QRadar', 'LogRhythm', 'Rapid7 InsightIDR', 'Exabeam', 'Securonix', 'Microsoft Sentinel']
                }
            };

            // Create consolidated assessment cards
            const consolidatedGrid = document.getElementById('consolidatedAssessmentGrid');
            consolidatedGrid.innerHTML = '';

            // Process CISA pillars with their Forrester counterparts
            cisaMaturityData.forEach(cisaData => {
                const forresterMatch = forresterData.find(f => {
                    const mapping = domainMapping[cisaData.pillar];
                    return mapping && f.domain === mapping.forrester;
                });

                const domainName = forresterMatch 
                    ? `${cisaData.pillar} / ${forresterMatch.domain}`
                    : cisaData.pillar;
                
                const tools = toolMapping[domainName]?.tools || cisaData.tools;
                const combinedPercentage = forresterMatch 
                    ? Math.round((cisaData.percentage + forresterMatch.percentage) / 2)
                    : cisaData.percentage;

                const card = document.createElement('div');
                card.className = 'consolidated-assessment-card';
                card.style.cursor = 'pointer';
                
                const domainData = {
                    domain: domainName,
                    cisa: cisaData,
                    forrester: forresterMatch,
                    tools: tools,
                    combinedPercentage: combinedPercentage
                };
                
                card.onclick = () => openModal(`Consolidated Assessment: ${domainName}`, generateConsolidatedModalContent(domainData));
                
                const colorClass = combinedPercentage < 30 ? 'danger' : combinedPercentage < 50 ? 'warning' : '';
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                        <h4 style="margin: 0; color: var(--dark-bg);">${domainName}</h4>
                        <span style="font-size: 24px; font-weight: 700; color: ${combinedPercentage < 30 ? 'var(--danger-red)' : combinedPercentage < 50 ? 'var(--warning-orange)' : 'var(--success-green)'};">${combinedPercentage}%</span>
                    </div>
                    
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-size: 12px; color: var(--text-secondary);">CISA ${cisaData.pillar}:</span>
                            <span style="font-size: 12px; font-weight: 600;">${cisaData.percentage}% (${cisaData.current})</span>
                        </div>
                        ${forresterMatch ? `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-size: 12px; color: var(--text-secondary);">Forrester ${forresterMatch.domain}:</span>
                            <span style="font-size: 12px; font-weight: 600;">${forresterMatch.percentage}% (${forresterMatch.score}/5)</span>
                        </div>
                        ` : ''}
                        <div class="maturity-level-bar" style="margin-top: 12px;">
                            <div class="maturity-level-fill ${colorClass}" style="width: ${combinedPercentage}%;"></div>
                        </div>
                    </div>

                    <div style="background: #F0F9FF; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                        <strong style="font-size: 12px; color: var(--primary-blue); display: block; margin-bottom: 8px;">üõ†Ô∏è Key Tools:</strong>
                        <div style="display: flex; flex-wrap: wrap; gap: 6px;">
                            ${tools.slice(0, 6).map(tool => `<span class="badge badge-info" style="font-size: 11px;">${tool}</span>`).join('')}
                            ${tools.length > 6 ? `<span class="badge badge-info" style="font-size: 11px;">+${tools.length - 6} more</span>` : ''}
                        </div>
                    </div>

                    <p style="font-size: 12px; color: var(--text-secondary); margin-top: 12px; font-style: italic;">
                        <strong>Gap:</strong> ${cisaData.gap}
                    </p>
                `;
                consolidatedGrid.appendChild(card);
            });

            // Add Forrester-only domains (Workplace, Visibility & Analytics)
            const forresterOnlyDomains = forresterData.filter(f => 
                !Object.values(domainMapping).some(m => m.forrester === f.domain)
            );

            forresterOnlyDomains.forEach(forresterData => {
                const tools = toolMapping[forresterData.domain]?.tools || forresterData.tools;
                
                const card = document.createElement('div');
                card.className = 'consolidated-assessment-card';
                card.style.cursor = 'pointer';
                
                const domainData = {
                    domain: forresterData.domain,
                    cisa: null,
                    forrester: forresterData,
                    tools: tools,
                    combinedPercentage: forresterData.percentage
                };
                
                card.onclick = () => openModal(`Consolidated Assessment: ${forresterData.domain}`, generateConsolidatedModalContent(domainData));
                
                const colorClass = forresterData.percentage < 30 ? 'danger' : forresterData.percentage < 50 ? 'warning' : '';
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                        <h4 style="margin: 0; color: var(--dark-bg);">${forresterData.domain}</h4>
                        <span style="font-size: 24px; font-weight: 700; color: ${forresterData.percentage < 30 ? 'var(--danger-red)' : forresterData.percentage < 50 ? 'var(--warning-orange)' : 'var(--success-green)'};">${forresterData.percentage}%</span>
                    </div>
                    
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-size: 12px; color: var(--text-secondary);">Forrester ${forresterData.domain}:</span>
                            <span style="font-size: 12px; font-weight: 600;">${forresterData.percentage}% (${forresterData.score}/5)</span>
                        </div>
                        <div class="maturity-level-bar" style="margin-top: 12px;">
                            <div class="maturity-level-fill ${colorClass}" style="width: ${forresterData.percentage}%;"></div>
                        </div>
                    </div>

                    <div style="background: #F0F9FF; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                        <strong style="font-size: 12px; color: var(--primary-blue); display: block; margin-bottom: 8px;">üõ†Ô∏è Key Tools:</strong>
                        <div style="display: flex; flex-wrap: wrap; gap: 6px;">
                            ${tools.slice(0, 6).map(tool => `<span class="badge badge-info" style="font-size: 11px;">${tool}</span>`).join('')}
                            ${tools.length > 6 ? `<span class="badge badge-info" style="font-size: 11px;">+${tools.length - 6} more</span>` : ''}
                        </div>
                    </div>
                `;
                consolidatedGrid.appendChild(card);
            });
            
            // Create overall maturity chart
            if (charts.overallMaturity) charts.overallMaturity.destroy();
            const overallCtx = document.getElementById('overallMaturityChart').getContext('2d');
            charts.overallMaturity = new Chart(overallCtx, {
                type: 'radar',
                data: {
                    labels: ['Identity', 'Devices', 'Networks', 'Applications', 'Data', 'Workforce', 'Workload', 'Workplace', 'Network', 'Device', 'Data', 'Visibility'],
                    datasets: [{
                        label: 'Current Maturity',
                        data: [35, 20, 40, 30, 15, 50, 40, 56, 44, 36, 30, 40],
                        backgroundColor: 'rgba(37, 99, 235, 0.2)',
                        borderColor: '#2563EB',
                        borderWidth: 2
                    }, {
                        label: 'Target Maturity',
                        data: [90, 85, 90, 85, 90, 90, 85, 90, 90, 85, 90, 85],
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        borderColor: '#10B981',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: { display: true, text: 'Combined CISA & Forrester ZTX Maturity Assessment' }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        function initializeStep3() {
            // Draw detailed network architecture with gap overlays (same as Step 1)
            const container = document.getElementById('gapAnalysisTopology');
            container.innerHTML = '';
            container.style.width = '100%';
            container.style.height = '800px';
            container.style.position = 'relative';
            
            // Define network architecture zones and devices (same as Step 1)
            const architecture = {
                internet: { x: 400, y: 20, width: 200, height: 60 },
                dmz: { x: 50, y: 100, width: 900, height: 120 },
                core: { x: 50, y: 240, width: 900, height: 180 },
                distribution: { x: 50, y: 440, width: 900, height: 200 },
                access: { x: 50, y: 660, width: 900, height: 120 }
            };

            // Gap mappings to network components
            const gapMappings = {
                'Identity & Access': { zones: ['management'], devices: ['AD-DC-01', 'AD-DC-02'], priority: 'Critical' },
                'Device Management': { zones: ['access'], devices: ['ACC-SW-01', 'ACC-SW-02', 'WIFI-CTRL'], priority: 'Critical' },
                'Network Segmentation': { zones: ['core', 'distribution'], devices: ['CORE-SW-01', 'CORE-SW-02', 'DIST-SW-01', 'DIST-SW-02'], priority: 'High' },
                'Application Security': { zones: ['dmz', 'internal'], devices: ['WEB-01', 'WEB-02', 'APP-01', 'APP-02'], priority: 'High' },
                'Data Protection': { zones: ['data'], devices: ['DB-01', 'DB-02', 'DB-03', 'DB-04'], priority: 'Critical' },
                'Visibility & Analytics': { zones: ['core', 'distribution'], devices: ['CORE-RTR-01', 'CORE-RTR-02'], priority: 'High' }
            };

            // Draw network layers
            Object.keys(architecture).forEach((layer, idx) => {
                const layerDiv = document.createElement('div');
                layerDiv.className = 'network-layer';
                layerDiv.style.left = architecture[layer].x + 'px';
                layerDiv.style.top = architecture[layer].y + 'px';
                layerDiv.style.width = architecture[layer].width + 'px';
                layerDiv.style.height = architecture[layer].height + 'px';
                container.appendChild(layerDiv);

                const label = document.createElement('div');
                label.className = 'network-layer-label';
                label.textContent = layer.toUpperCase();
                label.style.left = (architecture[layer].x + 10) + 'px';
                label.style.top = (architecture[layer].y - 12) + 'px';
                container.appendChild(label);
            });

            // Internet Gateway
            const internetZone = document.createElement('div');
            internetZone.className = 'network-zone';
            internetZone.style.left = architecture.internet.x + 'px';
            internetZone.style.top = architecture.internet.y + 'px';
            internetZone.style.width = architecture.internet.width + 'px';
            internetZone.style.height = architecture.internet.height + 'px';
            const internetLabel = document.createElement('div');
            internetLabel.className = 'network-zone-label';
            internetLabel.textContent = 'Internet';
            internetLabel.style.color = '#EF4444';
            internetZone.appendChild(internetLabel);
            container.appendChild(internetZone);

            // DMZ Zone with gap overlay
            const dmzZone = document.createElement('div');
            dmzZone.className = 'network-zone dmz';
            dmzZone.style.left = architecture.dmz.x + 'px';
            dmzZone.style.top = architecture.dmz.y + 'px';
            dmzZone.style.width = architecture.dmz.width + 'px';
            dmzZone.style.height = architecture.dmz.height + 'px';
            const dmzLabel = document.createElement('div');
            dmzLabel.className = 'network-zone-label';
            dmzLabel.textContent = 'DMZ Zone';
            dmzLabel.style.color = '#EF4444';
            dmzZone.appendChild(dmzLabel);
            if (gapMappings['Application Security'].zones.includes('dmz')) {
                const gapOverlay = document.createElement('div');
                gapOverlay.className = 'gap-overlay high';
                gapOverlay.style.left = architecture.dmz.x + 'px';
                gapOverlay.style.top = architecture.dmz.y + 'px';
                gapOverlay.style.width = architecture.dmz.width + 'px';
                gapOverlay.style.height = architecture.dmz.height + 'px';
                gapOverlay.title = 'Application Security Gap: No App-level Controls, Missing API Security';
                container.appendChild(gapOverlay);
            }
            container.appendChild(dmzZone);

            // DMZ Devices with gap markers
            const dmzDevices = [
                { type: 'firewall', name: 'FW-DMZ-01', x: 150, y: 140 },
                { type: 'firewall', name: 'FW-DMZ-02', x: 250, y: 140 },
                { type: 'loadbalancer', name: 'LB-WEB-01', x: 400, y: 140 },
                { type: 'loadbalancer', name: 'LB-WEB-02', x: 500, y: 140 },
                { type: 'server', name: 'WEB-01', x: 650, y: 140 },
                { type: 'server', name: 'WEB-02', x: 750, y: 140 },
                { type: 'server', name: 'WEB-03', x: 850, y: 140 }
            ];

            dmzDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.dmz.x + device.x, architecture.dmz.y + device.y);
                if (gapMappings['Application Security'].devices.includes(device.name)) {
                    addGapMarker(container, architecture.dmz.x + device.x + 50, architecture.dmz.y + device.y - 10, 'High');
                }
                container.appendChild(dev);
            });

            // Core Network Zone with gap overlay
            const coreZone = document.createElement('div');
            coreZone.className = 'network-zone internal';
            coreZone.style.left = architecture.core.x + 'px';
            coreZone.style.top = architecture.core.y + 'px';
            coreZone.style.width = architecture.core.width + 'px';
            coreZone.style.height = architecture.core.height + 'px';
            const coreLabel = document.createElement('div');
            coreLabel.className = 'network-zone-label';
            coreLabel.textContent = 'Core Network';
            coreLabel.style.color = '#2563EB';
            coreZone.appendChild(coreLabel);
            if (gapMappings['Network Segmentation'].zones.includes('core') || gapMappings['Visibility & Analytics'].zones.includes('core')) {
                const gapOverlay = document.createElement('div');
                gapOverlay.className = 'gap-overlay high';
                gapOverlay.style.left = architecture.core.x + 'px';
                gapOverlay.style.top = architecture.core.y + 'px';
                gapOverlay.style.width = architecture.core.width + 'px';
                gapOverlay.style.height = architecture.core.height + 'px';
                gapOverlay.title = 'Network Segmentation & Visibility Gaps';
                container.appendChild(gapOverlay);
            }
            container.appendChild(coreZone);

            // Core Devices with gap markers
            const coreDevices = [
                { type: 'router', name: 'CORE-RTR-01', x: 100, y: 280 },
                { type: 'router', name: 'CORE-RTR-02', x: 200, y: 280 },
                { type: 'switch', name: 'CORE-SW-01', x: 350, y: 280 },
                { type: 'switch', name: 'CORE-SW-02', x: 450, y: 280 },
                { type: 'firewall', name: 'FW-INT-01', x: 600, y: 280 },
                { type: 'firewall', name: 'FW-INT-02', x: 700, y: 280 },
                { type: 'loadbalancer', name: 'LB-APP-01', x: 800, y: 280 }
            ];

            coreDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.core.x + device.x, architecture.core.y + device.y);
                if (gapMappings['Network Segmentation'].devices.includes(device.name) || gapMappings['Visibility & Analytics'].devices.includes(device.name)) {
                    addGapMarker(container, architecture.core.x + device.x + 50, architecture.core.y + device.y - 10, 'High');
                }
                container.appendChild(dev);
            });

            // Distribution Layer with gap overlay
            const distDevices = [
                { type: 'switch', name: 'DIST-SW-01', x: 100, y: 480 },
                { type: 'switch', name: 'DIST-SW-02', x: 250, y: 480 },
                { type: 'switch', name: 'DIST-SW-03', x: 400, y: 480 },
                { type: 'switch', name: 'DIST-SW-04', x: 550, y: 480 },
                { type: 'switch', name: 'DIST-SW-05', x: 700, y: 480 },
                { type: 'switch', name: 'DIST-SW-06', x: 850, y: 480 }
            ];

            if (gapMappings['Network Segmentation'].zones.includes('distribution')) {
                const gapOverlay = document.createElement('div');
                gapOverlay.className = 'gap-overlay high';
                gapOverlay.style.left = architecture.distribution.x + 'px';
                gapOverlay.style.top = architecture.distribution.y + 'px';
                gapOverlay.style.width = architecture.distribution.width + 'px';
                gapOverlay.style.height = architecture.distribution.height + 'px';
                gapOverlay.title = 'Network Segmentation Gap: Missing Micro-segmentation';
                container.appendChild(gapOverlay);
            }

            distDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.distribution.x + device.x, architecture.distribution.y + device.y);
                if (gapMappings['Network Segmentation'].devices.includes(device.name)) {
                    addGapMarker(container, architecture.distribution.x + device.x + 50, architecture.distribution.y + device.y - 10, 'High');
                }
                container.appendChild(dev);
            });

            // Management Zone with gap overlay
            const mgmtZone = document.createElement('div');
            mgmtZone.className = 'network-zone management';
            mgmtZone.style.left = architecture.distribution.x + 50 + 'px';
            mgmtZone.style.top = architecture.distribution.y + 60 + 'px';
            mgmtZone.style.width = 200 + 'px';
            mgmtZone.style.height = 120 + 'px';
            const mgmtLabel = document.createElement('div');
            mgmtLabel.className = 'network-zone-label';
            mgmtLabel.textContent = 'Management';
            mgmtLabel.style.color = '#10B981';
            mgmtZone.appendChild(mgmtLabel);
            if (gapMappings['Identity & Access'].zones.includes('management')) {
                const gapOverlay = document.createElement('div');
                gapOverlay.className = 'gap-overlay';
                gapOverlay.style.left = (architecture.distribution.x + 50) + 'px';
                gapOverlay.style.top = (architecture.distribution.y + 60) + 'px';
                gapOverlay.style.width = 200 + 'px';
                gapOverlay.style.height = 120 + 'px';
                gapOverlay.title = 'Identity & Access Gap: Missing MFA, No IAM Framework';
                container.appendChild(gapOverlay);
            }
            container.appendChild(mgmtZone);

            const mgmtDevices = [
                { type: 'server', name: 'AD-DC-01', x: 70, y: 540 },
                { type: 'server', name: 'AD-DC-02', x: 170, y: 540 },
                { type: 'server', name: 'FILE-01', x: 70, y: 580 },
                { type: 'server', name: 'EXCH-01', x: 170, y: 580 }
            ];

            mgmtDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.distribution.x + device.x, architecture.distribution.y + device.y);
                if (gapMappings['Identity & Access'].devices.includes(device.name)) {
                    addGapMarker(container, architecture.distribution.x + device.x + 50, architecture.distribution.y + device.y - 10, 'Critical');
                }
                container.appendChild(dev);
            });

            // Data Zone with gap overlay
            const dataZone = document.createElement('div');
            dataZone.className = 'network-zone data';
            dataZone.style.left = architecture.distribution.x + 300 + 'px';
            dataZone.style.top = architecture.distribution.y + 60 + 'px';
            dataZone.style.width = 200 + 'px';
            dataZone.style.height = 120 + 'px';
            const dataLabel = document.createElement('div');
            dataLabel.className = 'network-zone-label';
            dataLabel.textContent = 'Data Layer';
            dataLabel.style.color = '#8B5CF6';
            dataZone.appendChild(dataLabel);
            if (gapMappings['Data Protection'].zones.includes('data')) {
                const gapOverlay = document.createElement('div');
                gapOverlay.className = 'gap-overlay';
                gapOverlay.style.left = (architecture.distribution.x + 300) + 'px';
                gapOverlay.style.top = (architecture.distribution.y + 60) + 'px';
                gapOverlay.style.width = 200 + 'px';
                gapOverlay.style.height = 120 + 'px';
                gapOverlay.title = 'Data Protection Gap: No Encryption at Rest, Missing Data Classification';
                container.appendChild(gapOverlay);
            }
            container.appendChild(dataZone);

            const dataDevices = [
                { type: 'server', name: 'DB-01', x: 320, y: 540 },
                { type: 'server', name: 'DB-02', x: 420, y: 540 },
                { type: 'server', name: 'DB-03', x: 320, y: 580 },
                { type: 'server', name: 'DB-04', x: 420, y: 580 }
            ];

            dataDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.distribution.x + device.x, architecture.distribution.y + device.y);
                if (gapMappings['Data Protection'].devices.includes(device.name)) {
                    addGapMarker(container, architecture.distribution.x + device.x + 50, architecture.distribution.y + device.y - 10, 'Critical');
                }
                container.appendChild(dev);
            });

            // Application Zone with gap overlay
            const appZone = document.createElement('div');
            appZone.className = 'network-zone internal';
            appZone.style.left = architecture.distribution.x + 550 + 'px';
            appZone.style.top = architecture.distribution.y + 60 + 'px';
            appZone.style.width = 200 + 'px';
            appZone.style.height = 120 + 'px';
            const appLabel = document.createElement('div');
            appLabel.className = 'network-zone-label';
            appLabel.textContent = 'Application';
            appLabel.style.color = '#2563EB';
            appZone.appendChild(appLabel);
            if (gapMappings['Application Security'].zones.includes('internal')) {
                const gapOverlay = document.createElement('div');
                gapOverlay.className = 'gap-overlay high';
                gapOverlay.style.left = (architecture.distribution.x + 550) + 'px';
                gapOverlay.style.top = (architecture.distribution.y + 60) + 'px';
                gapOverlay.style.width = 200 + 'px';
                gapOverlay.style.height = 120 + 'px';
                gapOverlay.title = 'Application Security Gap: No App-level Controls';
                container.appendChild(gapOverlay);
            }
            container.appendChild(appZone);

            const appDevices = [
                { type: 'server', name: 'APP-01', x: 570, y: 540 },
                { type: 'server', name: 'APP-02', x: 670, y: 540 },
                { type: 'server', name: 'APP-03', x: 570, y: 580 },
                { type: 'server', name: 'APP-04', x: 670, y: 580 }
            ];

            appDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.distribution.x + device.x, architecture.distribution.y + device.y);
                if (gapMappings['Application Security'].devices.includes(device.name)) {
                    addGapMarker(container, architecture.distribution.x + device.x + 50, architecture.distribution.y + device.y - 10, 'High');
                }
                container.appendChild(dev);
            });

            // Access Layer with gap overlay
            if (gapMappings['Device Management'].zones.includes('access')) {
                const gapOverlay = document.createElement('div');
                gapOverlay.className = 'gap-overlay';
                gapOverlay.style.left = architecture.access.x + 'px';
                gapOverlay.style.top = architecture.access.y + 'px';
                gapOverlay.style.width = architecture.access.width + 'px';
                gapOverlay.style.height = architecture.access.height + 'px';
                gapOverlay.title = 'Device Management Gap: No Device Inventory, Missing Health Attestation';
                container.appendChild(gapOverlay);
            }

            const accessDevices = [
                { type: 'switch', name: 'ACC-SW-01', x: 100, y: 700 },
                { type: 'switch', name: 'ACC-SW-02', x: 250, y: 700 },
                { type: 'switch', name: 'ACC-SW-03', x: 400, y: 700 },
                { type: 'wifi', name: 'WIFI-CTRL', x: 550, y: 700 },
                { type: 'switch', name: 'ACC-SW-04', x: 700, y: 700 },
                { type: 'switch', name: 'ACC-SW-05', x: 850, y: 700 }
            ];

            accessDevices.forEach(device => {
                const dev = createDevice(device.type, device.name, architecture.access.x + device.x, architecture.access.y + device.y);
                if (gapMappings['Device Management'].devices.includes(device.name)) {
                    addGapMarker(container, architecture.access.x + device.x + 50, architecture.access.y + device.y - 10, 'Critical');
                }
                container.appendChild(dev);
            });

            // Draw connections
            drawConnections(container, architecture, dmzDevices, coreDevices, distDevices, accessDevices);
            
            // Create gap analysis cards
            const cardsContainer = document.getElementById('gapAnalysisCards');
            cardsContainer.innerHTML = '';
            gapAnalysisData.forEach((data, index) => {
                const card = document.createElement('div');
                card.className = 'maturity-card';
                card.style.cursor = 'pointer';
                card.onclick = () => openModal(`Gap Analysis: ${data.domain}`, generateGapAnalysisModalContent(data));
                card.innerHTML = `
                    <h4>${data.domain}</h4>
                    <div style="margin-bottom: 12px;">
                        <span class="badge ${data.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}">${data.priority} Priority</span>
                        <span class="badge badge-info" style="margin-left: 8px;">${data.gaps} Gaps</span>
                    </div>
                    <p style="font-size: 13px; color: var(--text-secondary); margin-top: 12px;">
                        <strong>Current:</strong> ${data.current}<br>
                        <strong>Target:</strong> ${data.target}
                    </p>
                `;
                cardsContainer.appendChild(card);
            });
        }

        function addGapMarker(container, x, y, priority) {
            const marker = document.createElement('div');
            marker.className = `gap-marker ${priority === 'Critical' ? '' : 'high'}`;
            marker.style.left = x + 'px';
            marker.style.top = y + 'px';
            marker.title = `Gap identified - ${priority} priority`;
            container.appendChild(marker);
        }

        function initializeStep4() {
            const container = document.getElementById('securityLayerCards');
            container.innerHTML = '';
            securityLayerData.forEach((data, index) => {
                const card = document.createElement('div');
                card.className = 'maturity-card';
                card.style.cursor = 'pointer';
                card.onclick = () => openModal(`Security Layer Assessment: ${data.layer}`, generateSecurityLayerModalContent(data));
                const colorClass = data.percentage < 30 ? 'danger' : data.percentage < 50 ? 'warning' : '';
                card.innerHTML = `
                    <h4>üõ°Ô∏è ${data.layer}</h4>
                    <div class="maturity-level">
                        <span style="font-size: 12px; color: var(--text-secondary);">Status: ${data.status}</span>
                        <div class="maturity-level-bar">
                            <div class="maturity-level-fill ${colorClass}" style="width: ${data.percentage}%;"></div>
                        </div>
                        <span style="font-size: 12px; font-weight: 600; color: ${data.percentage < 30 ? 'var(--danger-red)' : data.percentage < 50 ? 'var(--warning-orange)' : 'var(--success-green)'};">${data.percentage}%</span>
                    </div>
                    <p style="font-size: 13px; color: var(--text-secondary); margin-top: 12px;">
                        <strong>Findings:</strong> ${data.issues} ${data.priority === 'Critical' ? 'Critical' : 'High Priority'} Issues
                    </p>
                    <div style="margin-top: 12px;">
                        <span class="badge ${data.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}">${data.issues} Issues</span>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Helper function to generate Architectural Layer modal content
        function generateArchLayerModalContent(layer) {
            return `
                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üìä Layer Overview</h6>
                    <table style="width: 100%;">
                        <tr><td style="width: 30%; font-weight: 600; padding: 8px 0;">Architectural Layer:</td><td style="padding: 8px 0;">${layer.name}</td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Priority:</td><td style="padding: 8px 0;"><span class="badge ${layer.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}">${layer.priority}</span></td></tr>
                        <tr><td style="font-weight: 600; padding: 8px 0;">Total Gaps:</td><td style="padding: 8px 0;">${layer.gaps.length} gaps identified</td></tr>
                    </table>
                </div>

                <div style="margin-bottom: 20px;">
                    <strong style="color: var(--dark-bg); font-size: 16px;">Description:</strong>
                    <p style="color: var(--text-secondary); margin: 8px 0 0 0; line-height: 1.6;">${layer.description}</p>
                </div>

                <h6 style="margin: 30px 0 16px 0; color: var(--dark-bg); font-size: 18px;">üîç Identified Gaps</h6>
                ${layer.detailedGaps ? layer.detailedGaps.map((gap, gapIndex) => `
                    <div style="background: white; border: 2px solid ${layer.priority === 'Critical' ? '#EF4444' : '#F59E0B'}; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                            <h6 style="margin: 0; color: var(--dark-bg); font-size: 18px;">Gap ${gapIndex + 1}: ${gap.name}</h6>
                            <span class="badge ${layer.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}">${layer.priority}</span>
                        </div>
                        
                        <div style="margin-bottom: 16px;">
                            <strong style="color: var(--dark-bg);">Description:</strong>
                            <p style="color: var(--text-secondary); margin: 8px 0 0 0; line-height: 1.6;">${gap.description}</p>
                        </div>

                        <div style="margin-bottom: 16px;">
                            <strong style="color: var(--dark-bg);">Business Impact:</strong>
                            <p style="color: var(--text-secondary); margin: 8px 0 0 0; line-height: 1.6;">${gap.impact}</p>
                        </div>

                        <div style="margin-bottom: 16px;">
                            <strong style="color: var(--dark-bg); margin-bottom: 8px; display: block;">Recommended Tools:</strong>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                ${gap.tools.map(tool => `<span class="badge badge-info" style="font-size: 12px;">${tool}</span>`).join('')}
                            </div>
                            <p style="color: var(--text-secondary); margin-top: 8px; font-size: 12px; font-style: italic;">Recommended: ${gap.tools[0]} or ${gap.tools[1]}</p>
                        </div>

                        <div style="margin-bottom: 16px;">
                            <strong style="color: var(--dark-bg); margin-bottom: 8px; display: block;">Remediation Steps:</strong>
                            <ol style="margin: 8px 0 0 0; padding-left: 24px; color: var(--text-secondary); line-height: 1.8;">
                                ${gap.remediation.map(step => `<li>${step}</li>`).join('')}
                            </ol>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 16px;">
                            <div style="background: #F9FAFB; padding: 12px; border-radius: 6px;">
                                <strong style="color: var(--dark-bg); font-size: 12px;">Timeline:</strong>
                                <p style="margin: 4px 0 0 0; color: var(--text-secondary); font-size: 14px; font-weight: 600;">${gap.timeline}</p>
                            </div>
                            <div style="background: #F9FAFB; padding: 12px; border-radius: 6px;">
                                <strong style="color: var(--dark-bg); font-size: 12px;">Estimated Cost:</strong>
                                <p style="margin: 4px 0 0 0; color: var(--text-secondary); font-size: 14px; font-weight: 600;">${gap.cost}</p>
                            </div>
                            <div style="background: #F9FAFB; padding: 12px; border-radius: 6px;">
                                <strong style="color: var(--dark-bg); font-size: 12px;">Complexity:</strong>
                                <p style="margin: 4px 0 0 0; color: var(--text-secondary); font-size: 14px; font-weight: 600;">${gap.complexity}</p>
                            </div>
                            <div style="background: #F9FAFB; padding: 12px; border-radius: 6px;">
                                <strong style="color: var(--dark-bg); font-size: 12px;">Dependencies:</strong>
                                <p style="margin: 4px 0 0 0; color: var(--text-secondary); font-size: 12px;">${gap.dependencies.join(', ')}</p>
                            </div>
                        </div>

                        <div style="background: #FEF3C7; padding: 12px; border-radius: 6px; border-left: 3px solid var(--warning-orange);">
                            <strong style="color: #92400E; font-size: 12px;">Standards & Compliance References:</strong>
                            <p style="margin: 4px 0 0 0; color: #78350F; font-size: 12px;">${gap.standards.join(', ')}</p>
                        </div>
                    </div>
                `).join('') : layer.gaps.map((gap, gapIndex) => `
                    <div style="background: white; border: 2px solid ${layer.priority === 'Critical' ? '#EF4444' : '#F59E0B'}; border-radius: 8px; padding: 16px; margin-bottom: 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h6 style="margin: 0; color: var(--dark-bg); font-size: 16px;">Gap ${gapIndex + 1}: ${gap}</h6>
                            <span class="badge ${layer.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}">${layer.priority}</span>
                        </div>
                    </div>
                `).join('')}

                <div style="background: #F0F9FF; padding: 16px; border-radius: 8px; margin-top: 20px; border-left: 4px solid var(--primary-blue);">
                    <h6 style="margin: 0 0 12px 0; color: var(--primary-blue); font-size: 16px;">üõ†Ô∏è Recommended Tools for ${layer.name}</h6>
                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                        ${layer.tools ? layer.tools.map(tool => `<span class="badge badge-info" style="font-size: 12px;">${tool}</span>`).join('') : ''}
                    </div>
                </div>

                <div style="background: #FEF3C7; padding: 12px; border-radius: 6px; margin-top: 16px; border-left: 3px solid var(--warning-orange);">
                    <strong style="color: #92400E; font-size: 12px;">üìã Standards & Compliance References:</strong>
                    <p style="margin: 4px 0 0 0; color: #78350F; font-size: 12px;">${layer.standards ? layer.standards.join(', ') : ''}</p>
                </div>
            `;
        }

        function initializeStep5() {
            // Create architectural diagram with gaps
            const archContainer = document.getElementById('gapArchitectureDiagram');
            archContainer.innerHTML = '';
            
            const archLayers = [
                { 
                    name: 'Identity & Access Layer', 
                    gaps: ['Missing MFA', 'No IAM Framework', 'No SSO'], 
                    priority: 'Critical',
                    description: 'The Identity & Access Layer is responsible for authenticating and authorizing users, devices, and applications. This layer ensures that only authorized entities can access resources based on verified identity and context.',
                    detailedGaps: [
                        {
                            name: 'Missing Multi-Factor Authentication (MFA)',
                            description: 'No MFA implementation for user authentication. All users rely solely on username/password credentials, creating significant security risk.',
                            impact: 'High risk of credential theft and unauthorized access. Vulnerable to phishing attacks and password breaches.',
                            tools: ['Okta', 'Azure AD MFA', 'Duo Security', 'Google Authenticator', 'Authy', 'Microsoft Authenticator'],
                            remediation: [
                                'Deploy MFA solution (Okta, Azure AD, or Duo recommended)',
                                'Enforce MFA for all user accounts, starting with privileged users',
                                'Configure backup authentication methods (SMS, email, hardware tokens)',
                                'Implement conditional access policies based on risk',
                                'Train users on MFA usage and security best practices'
                            ],
                            timeline: '2-4 months',
                            cost: '$$$ (Medium-High)',
                            complexity: 'Medium',
                            dependencies: ['Identity provider integration', 'User directory synchronization'],
                            standards: ['NIST 800-63B', 'CISA Identity Pillar - Advanced Level', 'Forrester Workforce Domain']
                        },
                        {
                            name: 'No Identity Governance Framework',
                            description: 'Lack of centralized identity governance, access certification, and role-based access control (RBAC) framework.',
                            impact: 'Inability to manage user access lifecycle, orphaned accounts, excessive permissions, compliance violations.',
                            tools: ['SailPoint', 'CyberArk', 'Saviynt', 'ForgeRock', 'Ping Identity', 'Microsoft Entra ID Governance'],
                            remediation: [
                                'Deploy identity governance platform (SailPoint or CyberArk recommended)',
                                'Define role-based access control (RBAC) model',
                                'Implement access certification and recertification processes',
                                'Establish identity lifecycle management workflows',
                                'Configure automated provisioning and deprovisioning',
                                'Set up access request and approval workflows'
                            ],
                            timeline: '4-6 months',
                            cost: '$$$$ (High)',
                            complexity: 'High',
                            dependencies: ['Directory services integration', 'Application connectors', 'HR system integration'],
                            standards: ['ISO 27001 Access Control', 'CISA Identity Pillar - Optimal Level', 'Forrester Workforce Domain']
                        },
                        {
                            name: 'Missing Single Sign-On (SSO)',
                            description: 'Users must authenticate separately to each application, leading to password fatigue and security risks.',
                            impact: 'Poor user experience, password reuse, increased support tickets, security vulnerabilities.',
                            tools: ['Okta', 'Azure AD SSO', 'Ping Identity', 'OneLogin', 'JumpCloud', 'Google Workspace SSO'],
                            remediation: [
                                'Deploy SSO solution (Okta or Azure AD recommended)',
                                'Configure SAML/OIDC/OAuth protocols for applications',
                                'Migrate applications to SSO-enabled authentication',
                                'Implement just-in-time (JIT) provisioning',
                                'Configure session management and timeout policies'
                            ],
                            timeline: '3-5 months',
                            cost: '$$$ (Medium-High)',
                            complexity: 'Medium',
                            dependencies: ['Identity provider setup', 'Application compatibility assessment'],
                            standards: ['SAML 2.0', 'OAuth 2.0', 'OpenID Connect', 'CISA Identity Pillar - Advanced Level']
                        }
                    ],
                    tools: ['Okta', 'Azure AD', 'Microsoft Entra ID', 'SailPoint', 'CyberArk', 'Ping Identity', 'Duo Security'],
                    standards: ['NIST 800-63B', 'CISA Identity Pillar', 'ISO 27001 Access Control', 'Forrester Workforce Domain']
                },
                { 
                    name: 'Network Layer', 
                    gaps: ['No Micro-segmentation', 'Missing SDP'], 
                    priority: 'High',
                    description: 'The Network Layer provides secure network connectivity, segmentation, and access controls. This layer ensures that network traffic is properly segmented and monitored to prevent lateral movement.',
                    detailedGaps: [
                        {
                            name: 'No Micro-segmentation',
                            description: 'Network relies on traditional VLAN-based segmentation, allowing lateral movement between segments.',
                            impact: 'Compromised device can access entire network segment, increased attack surface, difficult to contain breaches.',
                            tools: ['Illumio', 'Guardicore', 'VMware NSX', 'Cisco ACI', 'Palo Alto Prisma Access', 'Zscaler ZPA'],
                            remediation: [
                                'Deploy micro-segmentation solution (Illumio or Guardicore recommended)',
                                'Map application dependencies and traffic flows',
                                'Define micro-segmentation policies (least privilege)',
                                'Implement workload-level segmentation',
                                'Configure dynamic policy enforcement',
                                'Monitor and optimize segmentation policies'
                            ],
                            timeline: '4-6 months',
                            cost: '$$$$ (High)',
                            complexity: 'High',
                            dependencies: ['Network infrastructure assessment', 'Application dependency mapping'],
                            standards: ['CISA Networks Pillar - Advanced Level', 'Forrester Network Domain', 'NIST 800-207']
                        },
                        {
                            name: 'Missing Software-Defined Perimeter (SDP)',
                            description: 'No zero trust network access, traditional VPN-based remote access with broad network access.',
                            impact: 'Over-privileged remote access, VPN vulnerabilities, inability to enforce least privilege access.',
                            tools: ['Zscaler ZPA', 'Cloudflare Access', 'Perimeter 81', 'Cato Networks', 'Twingate', 'NetFoundry'],
                            remediation: [
                                'Deploy SDP solution (Zscaler ZPA or Cloudflare Access recommended)',
                                'Replace or supplement traditional VPN',
                                'Configure application-specific access policies',
                                'Implement user-to-application segmentation',
                                'Enable continuous verification and monitoring',
                                'Integrate with identity provider for authentication'
                            ],
                            timeline: '3-5 months',
                            cost: '$$$ (Medium-High)',
                            complexity: 'Medium',
                            dependencies: ['Identity provider', 'Application inventory'],
                            standards: ['CISA Networks Pillar - Optimal Level', 'Forrester Network Domain', 'NIST 800-207']
                        }
                    ],
                    tools: ['Illumio', 'Guardicore', 'VMware NSX', 'Cisco ACI', 'Zscaler ZPA', 'Cloudflare Access', 'Palo Alto Firewalls'],
                    standards: ['NIST 800-207', 'CISA Networks Pillar', 'Forrester Network Domain']
                },
                { 
                    name: 'Application Layer', 
                    gaps: ['No App-level Controls', 'Missing API Security'], 
                    priority: 'High',
                    description: 'The Application Layer secures applications and APIs with fine-grained access controls, security policies, and monitoring capabilities.',
                    detailedGaps: [
                        {
                            name: 'No Application-Level Access Controls',
                            description: 'Applications rely solely on network perimeter security, no fine-grained access controls within applications.',
                            impact: 'Over-privileged application access, inability to enforce least privilege, increased attack surface.',
                            tools: ['Okta Advanced Server Access', 'CyberArk Conjur', 'HashiCorp Vault', 'AWS IAM', 'Azure RBAC', 'Google Cloud IAM'],
                            remediation: [
                                'Implement application-level identity and access management',
                                'Deploy API authentication and authorization',
                                'Configure role-based access control (RBAC) within applications',
                                'Implement attribute-based access control (ABAC) where applicable',
                                'Enable just-in-time (JIT) access provisioning',
                                'Set up access reviews and certifications'
                            ],
                            timeline: '4-6 months',
                            cost: '$$$ (Medium-High)',
                            complexity: 'High',
                            dependencies: ['Identity provider', 'Application architecture review'],
                            standards: ['CISA Applications Pillar - Advanced Level', 'Forrester Workload Domain', 'OWASP Top 10']
                        },
                        {
                            name: 'Missing API Security',
                            description: 'APIs lack proper authentication, authorization, rate limiting, and security controls.',
                            impact: 'API vulnerabilities, data exposure, unauthorized access, API abuse and attacks.',
                            tools: ['Kong API Gateway', 'Apigee', 'AWS API Gateway', 'Azure API Management', 'MuleSoft', '3scale'],
                            remediation: [
                                'Deploy API gateway solution (Kong or Apigee recommended)',
                                'Implement API authentication (OAuth 2.0, API keys)',
                                'Configure API rate limiting and throttling',
                                'Enable API security scanning and testing',
                                'Implement API versioning and lifecycle management',
                                'Set up API monitoring and analytics'
                            ],
                            timeline: '3-5 months',
                            cost: '$$$ (Medium-High)',
                            complexity: 'Medium',
                            dependencies: ['API inventory', 'Application architecture'],
                            standards: ['OWASP API Security Top 10', 'CISA Applications Pillar - Advanced Level']
                        }
                    ],
                    tools: ['Kong API Gateway', 'Apigee', 'AWS WAF', 'Cloudflare WAF', 'Veracode', 'Checkmarx'],
                    standards: ['OWASP Top 10', 'CISA Applications Pillar', 'Forrester Workload Domain']
                },
                { 
                    name: 'Data Layer', 
                    gaps: ['No Encryption at Rest', 'Missing Data Classification', 'No DLP'], 
                    priority: 'Critical',
                    description: 'The Data Layer protects data through classification, encryption, access controls, and data loss prevention mechanisms.',
                    detailedGaps: [
                        {
                            name: 'No Encryption at Rest',
                            description: 'Data stored in databases, file systems, and storage lacks encryption, exposing sensitive data to unauthorized access.',
                            impact: 'Data breach risk, compliance violations (GDPR, HIPAA), unauthorized data access, regulatory penalties.',
                            tools: ['Microsoft BitLocker', 'VeraCrypt', 'AWS KMS', 'Azure Key Vault', 'Google Cloud KMS', 'HashiCorp Vault'],
                            remediation: [
                                'Implement database encryption (TDE, column-level encryption)',
                                'Enable file system encryption (BitLocker, FileVault)',
                                'Deploy cloud storage encryption (AWS S3, Azure Blob)',
                                'Implement key management solution (AWS KMS, Azure Key Vault)',
                                'Configure encryption key rotation policies',
                                'Establish encryption key backup and recovery procedures'
                            ],
                            timeline: '3-5 months',
                            cost: '$$$ (Medium-High)',
                            complexity: 'Medium',
                            dependencies: ['Storage infrastructure', 'Key management system'],
                            standards: ['NIST 800-175B', 'CISA Data Pillar - Advanced Level', 'Forrester Data Domain', 'GDPR', 'HIPAA']
                        },
                        {
                            name: 'Missing Data Classification Framework',
                            description: 'No systematic approach to classify data based on sensitivity, value, and regulatory requirements.',
                            impact: 'Inability to apply appropriate security controls, compliance gaps, over/under-protection of data.',
                            tools: ['Microsoft Purview', 'Varonis', 'Boldon James', 'Titus', 'Netwrix', 'Stealthbits'],
                            remediation: [
                                'Define data classification taxonomy (Public, Internal, Confidential, Restricted)',
                                'Deploy data classification solution (Microsoft Purview or Varonis)',
                                'Implement automated data discovery and classification',
                                'Configure classification labels and metadata',
                                'Train users on data classification procedures',
                                'Establish data handling policies based on classification'
                            ],
                            timeline: '4-6 months',
                            cost: '$$$ (Medium-High)',
                            complexity: 'Medium',
                            dependencies: ['Data discovery tools', 'User training'],
                            standards: ['ISO 27001 Information Classification', 'CISA Data Pillar - Advanced Level', 'GDPR']
                        },
                        {
                            name: 'No Data Loss Prevention (DLP)',
                            description: 'Lack of controls to prevent unauthorized data exfiltration, sharing, or leakage.',
                            impact: 'Data leakage risks, insider threats, compliance violations, intellectual property theft.',
                            tools: ['Microsoft Purview DLP', 'Forcepoint DLP', 'Symantec DLP', 'Digital Guardian', 'Proofpoint DLP', 'McAfee DLP'],
                            remediation: [
                                'Deploy DLP solution (Microsoft Purview or Forcepoint recommended)',
                                'Define DLP policies based on data classification',
                                'Configure endpoint DLP (block/prevent data exfiltration)',
                                'Implement network DLP (monitor data in transit)',
                                'Enable cloud DLP (protect data in cloud services)',
                                'Set up DLP incident response workflows'
                            ],
                            timeline: '4-6 months',
                            cost: '$$$$ (High)',
                            complexity: 'High',
                            dependencies: ['Data classification', 'Endpoint agents', 'Network infrastructure'],
                            standards: ['CISA Data Pillar - Optimal Level', 'Forrester Data Domain', 'GDPR', 'PCI-DSS']
                        }
                    ],
                    tools: ['Microsoft Purview', 'Varonis', 'Forcepoint DLP', 'AWS KMS', 'Azure Key Vault', 'Digital Guardian'],
                    standards: ['NIST 800-175B', 'CISA Data Pillar', 'Forrester Data Domain', 'GDPR', 'HIPAA']
                },
                { 
                    name: 'Device Layer', 
                    gaps: ['No Device Inventory', 'Missing Health Attestation'], 
                    priority: 'Critical',
                    description: 'The Device Layer manages and secures all devices accessing corporate resources, ensuring device compliance and health before granting access.',
                    detailedGaps: [
                        {
                            name: 'No Device Inventory Management',
                            description: 'Manual tracking of devices, no centralized device registry, unknown devices on network.',
                            impact: 'Shadow IT, unmanaged devices, inability to track device lifecycle, security blind spots.',
                            tools: ['Microsoft Intune', 'VMware Workspace ONE', 'Jamf Pro', 'SCCM', 'Tanium', 'Lansweeper'],
                            remediation: [
                                'Deploy unified endpoint management (UEM) solution (Intune or Workspace ONE)',
                                'Implement device discovery and inventory automation',
                                'Configure device registration and enrollment processes',
                                'Establish device classification and tagging',
                                'Set up device lifecycle management workflows',
                                'Integrate with network access control (NAC)'
                            ],
                            timeline: '3-5 months',
                            cost: '$$$ (Medium-High)',
                            complexity: 'Medium',
                            dependencies: ['Directory services', 'Network infrastructure'],
                            standards: ['CISA Devices Pillar - Initial Level', 'Forrester Device Domain']
                        },
                        {
                            name: 'Missing Device Health Attestation',
                            description: 'No capability to verify device security posture before granting network access.',
                            impact: 'Compromised or non-compliant devices can access network, increasing attack surface.',
                            tools: ['Microsoft Intune Compliance', 'VMware Workspace ONE Intelligence', 'Cisco ISE', 'Forescout'],
                            remediation: [
                                'Implement device compliance policies (OS version, encryption, antivirus status)',
                                'Configure health attestation checks before network access',
                                'Set up conditional access based on device compliance',
                                'Implement device remediation workflows',
                                'Enable continuous compliance monitoring'
                            ],
                            timeline: '2-4 months',
                            cost: '$$ (Medium)',
                            complexity: 'Medium',
                            dependencies: ['UEM platform', 'Network access control'],
                            standards: ['CISA Devices Pillar - Advanced Level', 'NIST 800-53 CM-7']
                        }
                    ],
                    tools: ['Microsoft Intune', 'VMware Workspace ONE', 'CrowdStrike Falcon', 'SentinelOne', 'Jamf Pro', 'Tanium'],
                    standards: ['CISA Devices Pillar', 'Forrester Device Domain', 'NIST 800-53 CM-7']
                },
                { 
                    name: 'Visibility Layer', 
                    gaps: ['No SIEM', 'Missing Behavioral Analytics'], 
                    priority: 'High',
                    description: 'The Visibility Layer provides comprehensive security monitoring, threat detection, behavioral analytics, and security orchestration capabilities.',
                    detailedGaps: [
                        {
                            name: 'No Security Information and Event Management (SIEM)',
                            description: 'Lack of centralized security event collection, correlation, and analysis platform.',
                            impact: 'Inability to detect security incidents, slow threat response, limited security visibility, compliance gaps.',
                            tools: ['Splunk', 'Microsoft Sentinel', 'IBM QRadar', 'LogRhythm', 'Rapid7 InsightIDR', 'Exabeam'],
                            remediation: [
                                'Deploy SIEM solution (Microsoft Sentinel or Splunk recommended)',
                                'Configure log collection from all security sources',
                                'Implement security event correlation rules',
                                'Set up automated threat detection and alerting',
                                'Configure security dashboards and reporting',
                                'Establish security incident response workflows'
                            ],
                            timeline: '4-6 months',
                            cost: '$$$$ (High)',
                            complexity: 'High',
                            dependencies: ['Log sources', 'Network infrastructure', 'Security tools integration'],
                            standards: ['CISA Visibility Domain - Advanced Level', 'Forrester Visibility & Analytics', 'NIST 800-53']
                        },
                        {
                            name: 'Missing Behavioral Analytics',
                            description: 'No user and entity behavior analytics (UEBA) to detect anomalous activities and insider threats.',
                            impact: 'Inability to detect insider threats, advanced persistent threats (APTs), account compromise, data exfiltration.',
                            tools: ['Exabeam', 'Securonix', 'Splunk UBA', 'Microsoft Sentinel UEBA', 'Varonis', 'Darktrace'],
                            remediation: [
                                'Deploy UEBA solution (Exabeam or Securonix recommended)',
                                'Configure baseline user and entity behavior profiles',
                                'Implement machine learning-based anomaly detection',
                                'Set up behavioral analytics dashboards',
                                'Configure automated threat detection and alerting',
                                'Integrate with SIEM for comprehensive visibility'
                            ],
                            timeline: '3-5 months',
                            cost: '$$$ (Medium-High)',
                            complexity: 'Medium',
                            dependencies: ['SIEM platform', 'Data sources', 'Identity systems'],
                            standards: ['CISA Visibility Domain - Optimal Level', 'Forrester Visibility & Analytics']
                        }
                    ],
                    tools: ['Microsoft Sentinel', 'Splunk', 'Exabeam', 'Securonix', 'Recorded Future', 'Darktrace'],
                    standards: ['CISA Visibility Domain', 'Forrester Visibility & Analytics', 'NIST 800-53']
                }
            ];
            
            archLayers.forEach(layer => {
                const layerDiv = document.createElement('div');
                layerDiv.className = `arch-layer ${layer.priority === 'Critical' ? 'has-gap' : 'has-gap high'}`;
                layerDiv.style.cursor = 'pointer';
                layerDiv.onclick = () => openModal(`Architectural Layer: ${layer.name}`, generateArchLayerModalContent(layer));
                layerDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <h4 style="margin: 0; color: var(--dark-bg);">${layer.name}</h4>
                        <span class="badge ${layer.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}">${layer.priority}</span>
                    </div>
                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                        ${layer.gaps.map(gap => `<span class="badge ${layer.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}" style="font-size: 11px;">${gap}</span>`).join('')}
                    </div>
                    <p style="margin-top: 12px; color: var(--text-secondary); font-size: 12px; font-style: italic;">Click to view detailed gap analysis...</p>
                `;
                archContainer.appendChild(layerDiv);
            });
            
            // Create detailed gap reports
            const reportsContainer = document.getElementById('gapReportsContainer');
            reportsContainer.innerHTML = '';
            gapAnalysisData.forEach((data, index) => {
                const report = document.createElement('div');
                report.className = 'roadmap-item';
                report.style.cursor = 'pointer';
                report.onclick = () => openModal(`Gap Report: ${data.domain}`, generateGapAnalysisModalContent(data));
                report.innerHTML = `
                    <h4>${data.domain} Gaps</h4>
                    <div style="margin-bottom: 16px;">
                        <span class="badge ${data.priority === 'Critical' ? 'badge-danger' : 'badge-warning'}">${data.priority} Priority</span>
                        <span class="badge badge-info" style="margin-left: 8px;">${data.gaps} Gaps Identified</span>
                    </div>
                    <table style="width: 100%; margin-top: 16px;">
                        <tr>
                            <td style="width: 30%; font-weight: 600;">Gap</td>
                            <td style="width: 35%;">Zero Trust Reference</td>
                            <td style="width: 35%;">Security Reference</td>
                        </tr>
                        <tr>
                            <td>${data.gap.split(',')[0]}</td>
                            <td>CISA ${data.domain} Pillar - Advanced level requirement</td>
                            <td>NIST 800-207: ${data.domain} requirements</td>
                        </tr>
                    </table>
                    <p style="margin-top: 12px; color: var(--text-secondary); font-size: 13px; font-style: italic;">Click to view detailed gap analysis...</p>
                `;
                reportsContainer.appendChild(report);
            });
        }

        function initializeStep6() {
            // Create visual roadmap timeline
            const timelineContainer = document.getElementById('roadmapTimelineVisual');
            timelineContainer.innerHTML = '';
            
            const timelinePhases = [
                { 
                    name: 'Phase 1: Foundation', 
                    date: 'Months 1-3',
                    priority: 'critical',
                    initiatives: ['Implement Multi-Factor Authentication (MFA)', 'Deploy Data Encryption at Rest', 'Establish Device Inventory Management', 'Implement Identity Governance Framework'],
                    description: 'Build foundational Zero Trust capabilities to address critical security gaps'
                },
                { 
                    name: 'Phase 2: Network Security', 
                    date: 'Months 4-6',
                    priority: 'high',
                    initiatives: ['Implement Network Micro-segmentation', 'Deploy Software-Defined Perimeter (SDP)', 'Enhance Network Monitoring'],
                    description: 'Implement network-level Zero Trust controls and segmentation'
                },
                { 
                    name: 'Phase 3: Advanced Controls', 
                    date: 'Months 7-9',
                    priority: 'medium',
                    initiatives: ['Implement Application-Level Access Controls', 'Deploy Data Loss Prevention (DLP)', 'Enhance Visibility & Analytics with SIEM'],
                    description: 'Deploy advanced security controls and monitoring capabilities'
                },
                { 
                    name: 'Phase 4: Continuous Improvement', 
                    date: 'Months 10-12',
                    priority: 'medium',
                    initiatives: ['Automate Security Policies', 'Continuous Assessment & Optimization', 'Achieve Optimal Maturity Level'],
                    description: 'Optimize and mature Zero Trust implementation'
                }
            ];
            
            timelinePhases.forEach((phase, index) => {
                const phaseDiv = document.createElement('div');
                phaseDiv.className = `roadmap-phase ${phase.priority}`;
                phaseDiv.innerHTML = `
                    <div class="phase-date">${phase.date}</div>
                    <div class="roadmap-phase-card">
                        <h4 style="margin-bottom: 8px; color: var(--dark-bg);">${phase.name}</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 16px; font-size: 14px;">${phase.description}</p>
                        <div style="margin-bottom: 16px;">
                            <span class="badge ${phase.priority === 'critical' ? 'badge-danger' : phase.priority === 'high' ? 'badge-warning' : 'badge-info'}">${phase.priority.charAt(0).toUpperCase() + phase.priority.slice(1)} Priority</span>
                        </div>
                        <div>
                            <h5 style="margin-bottom: 12px; color: var(--dark-bg); font-size: 16px;">Key Initiatives:</h5>
                            <ul style="margin-left: 20px; line-height: 2;">
                                ${phase.initiatives.map(init => `<li style="color: var(--text-secondary);">${init}</li>`).join('')}
                            </ul>
                        </div>
                        <p style="margin-top: 12px; color: var(--text-secondary); font-size: 13px; font-style: italic;">Click to view detailed phase information...</p>
                    </div>
                `;
                const cardElement = phaseDiv.querySelector('.roadmap-phase-card');
                cardElement.onclick = () => openModal(phase.name, generateRoadmapPhaseModalContent(phase));
                timelineContainer.appendChild(phaseDiv);
            });
            
            // Create roadmap phases container (detailed view)
            const phasesContainer = document.getElementById('roadmapPhasesContainer');
            phasesContainer.innerHTML = '';
            const detailedPhases = [
                { 
                    name: 'Phase 1: Foundation (Months 1-3)', 
                    priority: 'Critical', 
                    initiatives: ['Implement MFA', 'Deploy Data Encryption', 'Establish Device Inventory', 'Implement Identity Governance'],
                    description: 'Build foundational Zero Trust capabilities to address critical security gaps',
                    timeline: 'Months 1-3',
                    expectedOutcomes: 'Address critical security gaps, establish foundational Zero Trust capabilities, improve overall security posture by 30-40%'
                },
                { 
                    name: 'Phase 2: Network Security (Months 4-6)', 
                    priority: 'High', 
                    initiatives: ['Implement Micro-segmentation', 'Deploy SDP', 'Enhance Network Monitoring'],
                    description: 'Implement network-level Zero Trust controls and segmentation',
                    timeline: 'Months 4-6',
                    expectedOutcomes: 'Enhance network security, implement advanced segmentation, improve threat detection capabilities'
                },
                { 
                    name: 'Phase 3: Advanced Controls (Months 7-9)', 
                    priority: 'Medium', 
                    initiatives: ['Implement App-level Access Controls', 'Deploy DLP', 'Enhance Visibility & Analytics'],
                    description: 'Deploy advanced security controls and monitoring capabilities',
                    timeline: 'Months 7-9',
                    expectedOutcomes: 'Deploy advanced security controls, enhance visibility, improve incident response capabilities'
                },
                { 
                    name: 'Phase 4: Continuous Improvement (Months 10-12)', 
                    priority: 'Ongoing', 
                    initiatives: ['Automate Security Policies', 'Continuous Assessment & Optimization'],
                    description: 'Optimize and mature Zero Trust implementation',
                    timeline: 'Months 10-12',
                    expectedOutcomes: 'Optimize security operations, achieve advanced maturity levels, establish continuous improvement processes'
                }
            ];
            
            detailedPhases.forEach((phase, index) => {
                const phaseDiv = document.createElement('div');
                phaseDiv.className = 'roadmap-item';
                phaseDiv.style.cursor = 'pointer';
                phaseDiv.onclick = () => openModal(phase.name, generateRoadmapPhaseModalContent(phase));
                phaseDiv.innerHTML = `
                    <h4>${phase.name}</h4>
                    <div style="margin-bottom: 16px;">
                        <span class="badge ${phase.priority === 'Critical' ? 'badge-danger' : phase.priority === 'High' ? 'badge-warning' : 'badge-info'}">${phase.priority} Priority</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%;"></div>
                    </div>
                    <div style="margin-top: 16px;">
                        <h5 style="margin-bottom: 12px; color: var(--dark-bg);">Initiatives:</h5>
                        <ul style="margin-left: 24px; line-height: 2;">
                            ${phase.initiatives.map(init => `<li><strong>${init}</strong></li>`).join('')}
                        </ul>
                    </div>
                    <p style="margin-top: 12px; color: var(--text-secondary); font-size: 13px; font-style: italic;">Click to view detailed phase information...</p>
                `;
                phasesContainer.appendChild(phaseDiv);
            });
        }

        function exportRoadmap() {
            alert('Roadmap export functionality will generate a PDF or Excel file with the complete Zero Trust implementation roadmap.');
        }

        // Modal Functions
        function openModal(title, content) {
            const modal = document.getElementById('modalOverlay');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            
            modalTitle.textContent = title;
            modalBody.innerHTML = content;
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            const modal = document.getElementById('modalOverlay');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('modalOverlay');
            if (e.target === modal) {
                closeModal();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
    </script>
</body>
</html>